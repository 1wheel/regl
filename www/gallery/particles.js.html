<!DOCTYPE html>
      <html>
        <head>
          <title>example/particles.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(l,r,a){function b(e,c){if(!r[e]){if(!l[e]){var g="function"==typeof require&&require;if(!c&&g)return g(e,!0);if(p)return p(e,!0);g=Error("Cannot find module '"+e+"'");throw g.code="MODULE_NOT_FOUND",g;}g=r[e]={exports:{}};l[e][0].call(g.exports,function(a){var c=l[e][1][a];return b(c?c:a)},g,g.exports,e$$0,l,r,a)}return r[e].exports}for(var p="function"==typeof require&&require,f=0;f<a.length;f++)b(a[f]);return b})({1:[function(d,l,r){var a=d("../regl")(),b=d("gl-mat4"),p=d("hsv2rgb");
d=a.buffer(Array(1E4).fill().map(function(){var a=p(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var f=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:d,stride:44,offset:0},phase:{buffer:d,stride:44,offset:16},color:{buffer:d,stride:44,offset:32}},uniforms:{view:function(a){a=.01*a.tick;return b.lookAt([],[30*Math.cos(a),2.5,30*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a){return b.perspective([],Math.PI/4,a.viewportWidth/
a.viewportHeight,.01,1E3)},time:function(a){return.001*a.tick}},count:1E4,primitive:"points"});a.frame(function(){a.clear({depth:1,color:[0,0,0,1]});f()})},{"../regl":59,"gl-mat4":43,hsv2rgb:58}],2:[function(d,l,r){function a(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}l.exports=function(b,p,f,e,c){b=f.maxAttributes;p=Array(b);for(f=0;f<b;++f)p[f]=new a;return{Record:a,scope:{},state:p}}},{}],3:[function(d,
l,r){function a(a){return h[Object.prototype.toString.call(a)]|0}function b(a,b){for(var e=0;e<b.length;++e)a[e]=b[e]}function p(a,b,e,c,g,f,p){for(var k=0,n=0;n<e;++n)for(var m=0;m<c;++m)a[k++]=b[g*n+f*m+p]}var f=d("./util/is-typed-array"),e=d("./util/is-ndarray"),c=d("./util/values"),g=d("./util/pool");r=d("./util/flatten");var k=r.flatten,v=r.shape,h=d("./constants/arraytypes.json"),w=d("./constants/dtypes.json"),m=d("./constants/usage.json"),t=[];t[5120]=1;t[5122]=2;t[5124]=4;t[5121]=1;t[5123]=
2;t[5125]=4;t[5126]=4;l.exports=function(h,d,x){function u(a){this.id=y++;this.buffer=h.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;x.profile&&(this.stats={size:0})}function A(a,b,e){a.byteLength=b.byteLength;h.bufferData(a.type,b,e)}function l(c,n,h,m,d,u){c.usage=h;if(Array.isArray(n)){if(c.dtype=m||5126,0<n.length)if(Array.isArray(n[0])){d=v(n);for(var w=m=1;w<d.length;++w)m*=d[w];c.dimension=m;n=k(n,d,c.dtype);A(c,n,h);
u?c.persistentData=n:g.freeType(n)}else"number"===typeof n[0]?(c.dimension=d,d=g.allocType(c.dtype,n.length),b(d,n),A(c,d,h),u?c.persistentData=d:g.freeType(d)):f(n[0])&&(c.dimension=n[0].length,c.dtype=m||a(n[0])||5126,n=k(n,[n.length,n[0].length],c.dtype),A(c,n,h),u?c.persistentData=n:g.freeType(n))}else if(f(n))c.dtype=m||a(n),c.dimension=d,A(c,n,h),u&&(c.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(e(n)){d=n.shape;var t=n.stride,w=n.offset,z=0,H=0,x=0,y=0;1===d.length?(z=d[0],
H=1,x=t[0],y=0):2===d.length&&(z=d[0],H=d[1],x=t[0],y=t[1]);c.dtype=m||a(n.data)||5126;c.dimension=H;d=g.allocType(c.dtype,z*H);p(d,n.data,z,H,x,y,w);A(c,d,h);u?c.persistentData=d:g.freeType(d)}}function D(a){d.bufferCount--;h.deleteBuffer(a.buffer);a.buffer=null;delete n[a.id]}var y=0,n={};u.prototype.bind=function(){h.bindBuffer(this.type,this.buffer)};u.prototype.destroy=function(){D(this)};var L=[];x.profile&&(d.getTotalBufferSize=function(){var a=0;Object.keys(n).forEach(function(b){a+=n[b].stats.size});
return a});return{create:function(c,y,A,L){function r(a){var b=35044,c=null,g=0,p=0,n=1;Array.isArray(a)||f(a)||e(a)?c=a:"number"===typeof a?g=a|0:a&&("data"in a&&(c=a.data),"usage"in a&&(b=m[a.usage]),"type"in a&&(p=w[a.type]),"dimension"in a&&(n=a.dimension|0),"length"in a&&(g=a.length|0));B.bind();c?l(B,c,b,p,n,L):(h.bufferData(B.type,g,b),B.dtype=p||5121,B.usage=b,B.dimension=n,B.byteLength=g);x.profile&&(B.stats.size=B.byteLength*t[B.dtype]);return r}d.bufferCount++;var B=new u(y);n[B.id]=B;
A||r(c);r._reglType="buffer";r._buffer=B;r.subdata=function(c,n){var m=(n||0)|0,d;B.bind();if(Array.isArray(c)){if(0<c.length)if("number"===typeof c[0]){var u=g.allocType(B.dtype,c.length);b(u,c);h.bufferSubData(B.type,m,u);g.freeType(u)}else if(Array.isArray(c[0])||f(c[0]))d=v(c),u=k(c,d,B.dtype),h.bufferSubData(B.type,m,u),g.freeType(u)}else if(f(c))h.bufferSubData(B.type,m,c);else if(e(c)){d=c.shape;var w=c.stride,t=u=0,x=0,y=0;1===d.length?(u=d[0],t=1,x=w[0],y=0):2===d.length&&(u=d[0],t=d[1],
x=w[0],y=w[1]);d=Array.isArray(c.data)?B.dtype:a(c.data);d=g.allocType(d,u*t);p(d,c.data,u,t,x,y,c.offset);h.bufferSubData(B.type,m,d);g.freeType(d)}return r};x.profile&&(r.stats=B.stats);r.destroy=function(){D(B)};return r},createStream:function(a,b){var c=L.pop();c||(c=new u(a));c.bind();l(c,b,35040,0,1,!1);return c},destroyStream:function(a){L.push(a)},clear:function(){c(n).forEach(D);L.forEach(D)},getBuffer:function(a){return a&&a._buffer instanceof u?a._buffer:null},restore:function(){c(n).forEach(function(a){a.buffer=
h.createBuffer();h.bindBuffer(a.type,a.buffer);h.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:l}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/flatten":24,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/values":32}],4:[function(d,l,r){l.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,
"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(d,l,r){l.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(d,l,r){l.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(d,l,r){l.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(d,l,r){function a(a){return Array.isArray(a)||
v(a)||h(a)}function b(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function p(a,b,c,e){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=e}function f(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function e(a){return new p(!1,!1,!1,a)}function c(a,b){var c=a.type;return 0===c?(c=a.data.length,new p(!0,1<=c,2<=c,b)):4===c?(c=a.data,new p(c.thisDep,c.contextDep,c.propDep,b)):new p(3===c,2===c,1===c,b)}var g=d("./util/codegen"),k=d("./util/loop"),
v=d("./util/is-typed-array"),h=d("./util/is-ndarray"),w=d("./util/is-array-like"),m=d("./dynamic"),t=d("./constants/primitives.json"),z=d("./constants/dtypes.json"),F=["x","y","z","w"],x="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),u={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},A={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},C={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},D={cw:2304,ccw:2305},y=new p(!1,!1,!1,function(){});l.exports=function(n,
d,h,v,l,r,O,B,K,G,sa,H,ga,la,da){function W(a){return a.replace(".","_")}function P(a,b,c){var e=W(a);E.push(a);ta[e]=q[e]=!!c;ua[e]=b}function I(a,b,c){var e=W(a);E.push(a);Array.isArray(c)?(q[e]=c.slice(),ta[e]=c.slice()):q[e]=ta[e]=c;va[e]=b}function aa(){var a=g(),b=a.link,c=a.global;a.id=Ma++;a.batchId="0";var e=b(Ka),f=a.shared={props:"a0"};Object.keys(Ka).forEach(function(a){f[a]=c.def(e,".",a)});var p=a.next={},n=a.current={};Object.keys(va).forEach(function(a){Array.isArray(q[a])&&(p[a]=
c.def(f.next,".",a),n[a]=c.def(f.current,".",a))});var Na=a.constants={};Object.keys(Ga).forEach(function(a){Na[a]=c.def(JSON.stringify(Ga[a]))});a.invoke=function(c,e){switch(e.type){case 0:var q=["this",f.context,f.props,a.batchId];return c.def(b(e.data),".call(",q.slice(0,Math.max(e.data.length+1,4)),")");case 1:return c.def(f.props,e.data);case 2:return c.def(f.context,e.data);case 3:return c.def("this",e.data);case 4:return e.data.append(a,c),e.data.ref}};a.attribCache={};var Ia={};a.scopeAttrib=
function(a){a=d.id(a);if(a in Ia)return Ia[a];var c=G.scope[a];c||(c=G.scope[a]=new xa);return Ia[a]=b(c)};return a}function ma(a){var b=a["static"];a=a.dynamic;var q;if("profile"in b){var g=!!b.profile;q=e(function(a,b){return g});q.enable=g}else if("profile"in a){var f=a.profile;q=c(f,function(a,b){return a.invoke(b,f)})}return q}function wa(a,b){var q=a["static"],g=a.dynamic;if("framebuffer"in q){var f=q.framebuffer;return f?(f=B.getFramebuffer(f),e(function(a,b){var c=a.link(f),e=a.shared;b.set(e.framebuffer,
".next",c);e=e.context;b.set(e,".framebufferWidth",c+".width");b.set(e,".framebufferHeight",c+".height");return c})):e(function(a,b){var c=a.shared;b.set(c.framebuffer,".next","null");c=c.context;b.set(c,".framebufferWidth",c+".drawingBufferWidth");b.set(c,".framebufferHeight",c+".drawingBufferHeight");return"null"})}if("framebuffer"in g){var p=g.framebuffer;return c(p,function(a,b){var c=a.invoke(b,p),e=a.shared,q=e.framebuffer,c=b.def(q,".getFramebuffer(",c,")");b.set(q,".next",c);e=e.context;b.set(e,
".framebufferWidth",c+"?"+c+".width:"+e+".drawingBufferWidth");b.set(e,".framebufferHeight",c+"?"+c+".height:"+e+".drawingBufferHeight");return c})}return null}function T(a,b,e){function q(a){if(a in g){var e=g[a];a=!0;var M=e.x|0,La=e.y|0,n,k;"width"in e?n=e.width|0:a=!1;"height"in e?k=e.height|0:a=!1;return new p(!a&&b&&b.thisDep,!a&&b&&b.contextDep,!a&&b&&b.propDep,function(a,b){var c=a.shared.context,q=n;"width"in e||(q=b.def(c,".","framebufferWidth","-",M));var g=k;"height"in e||(g=b.def(c,".",
"framebufferHeight","-",La));return[M,La,q,g]})}if(a in f){var d=f[a];a=c(d,function(a,b){var c=a.invoke(b,d),e=a.shared.context,q=b.def(c,".x|0"),g=b.def(c,".y|0"),f=b.def('"width" in ',c,"?",c,".width|0:","(",e,".","framebufferWidth","-",q,")"),c=b.def('"height" in ',c,"?",c,".height|0:","(",e,".","framebufferHeight","-",g,")");return[q,g,f,c]});b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=a.propDep||b.propDep);return a}return b?new p(b.thisDep,b.contextDep,
b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var g=a["static"],f=a.dynamic;if(a=q("viewport")){var n=a;a=new p(a.thisDep,a.contextDep,a.propDep,function(a,b){var c=n.append(a,b),e=a.shared.context;b.set(e,".viewportWidth",c[2]);b.set(e,".viewportHeight",c[3]);return c})}return{viewport:a,scissor_box:q("scissor.box")}}function ha(a){function b(a){if(a in q){var f=d.id(q[a]);a=e(function(){return f});a.id=f;return a}if(a in
g){var p=g[a];return c(p,function(a,b){var c=a.invoke(b,p);return b.def(a.shared.strings,".id(",c,")")})}return null}var q=a["static"],g=a.dynamic,n=b("frag"),k=b("vert"),h=null;f(n)&&f(k)?(h=sa.program(k.id,n.id),a=e(function(a,b){return a.link(h)})):a=new p(n&&n.thisDep||k&&k.thisDep,n&&n.contextDep||k&&k.contextDep,n&&n.propDep||k&&k.propDep,function(a,b){var c=a.shared.shader,e;e=n?n.append(a,b):b.def(c,".","frag");var q;q=k?k.append(a,b):b.def(c,".","vert");return b.def(c+".program("+q+","+e+
")")});return{frag:n,vert:k,progVar:a,program:h}}function ja(b,q){function g(a,b){if(a in n){var q=n[a]|0;return e(function(a,c){b&&(a.OFFSET=q);return q})}if(a in k){var f=k[a];return c(f,function(a,c){var e=a.invoke(c,f);b&&(a.OFFSET=e);return e})}return b&&d?e(function(a,b){a.OFFSET="0";return 0}):null}var n=b["static"],k=b.dynamic,d=function(){if("elements"in n){var b=n.elements;a(b)?b=r.getElements(r.create(b,!0)):b&&(b=r.getElements(b));var q=e(function(a,c){if(b){var e=a.link(b);return a.ELEMENTS=
e}return a.ELEMENTS=null});q.value=b;return q}if("elements"in k){var g=k.elements;return c(g,function(a,b){var c=a.shared,e=c.isBufferArgs,c=c.elements,q=a.invoke(b,g),f=b.def("null"),e=b.def(e,"(",q,")"),q=a.cond(e).then(f,"=",c,".createStream(",q,");")["else"](f,"=",c,".getElements(",q,");");b.entry(q);b.exit(a.cond(e).then(c,".destroyStream(",f,");"));return a.ELEMENTS=f})}return null}(),h=g("offset",!0);return{elements:d,primitive:function(){if("primitive"in n){var a=n.primitive;return e(function(b,
c){return t[a]})}if("primitive"in k){var b=k.primitive;return c(b,function(a,c){var e=a.constants.primTypes,q=a.invoke(c,b);return c.def(e,"[",q,"]")})}return d?f(d)?d.value?e(function(a,b){return b.def(a.ELEMENTS,".primType")}):e(function(){return 4}):new p(d.thisDep,d.contextDep,d.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in n){var a=n.count|0;return e(function(){return a})}if("count"in k){var b=k.count;return c(b,function(a,
c){return a.invoke(c,b)})}return d?f(d)?d?h?new p(h.thisDep,h.contextDep,h.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):e(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):e(function(){return-1}):new p(d.thisDep||h.thisDep,d.contextDep||h.contextDep,d.propDep||h.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")}):null}(),instances:g("instances",!1),offset:h}}function oa(a,b){var q=a["static"],
g=a.dynamic,f={};E.forEach(function(a){function b(M,n){if(a in q){var k=M(q[a]);f[p]=e(function(){return k})}else if(a in g){var d=g[a];f[p]=c(d,function(a,b){return n(a,b,a.invoke(b,d))})}}var p=W(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return b(function(a){return a},function(a,b,c){return c});case "depth.func":return b(function(a){return A[a]},
function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case "depth.range":return b(function(a){return a},function(a,b,c){a=b.def("+",c,"[0]");b=b.def("+",c,"[1]");return[a,b]});case "blend.func":return b(function(a){return[u["srcRGB"in a?a.srcRGB:a.src],u["dstRGB"in a?a.dstRGB:a.dst],u["srcAlpha"in a?a.srcAlpha:a.src],u["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,c){function e(a,q){return b.def('"',a,q,'" in ',c,"?",c,".",a,q,":",c,".",a)}a=a.constants.blendFuncs;var q=e("src","RGB"),
g=e("dst","RGB"),q=b.def(a,"[",q,"]"),f=b.def(a,"[",e("src","Alpha"),"]"),g=b.def(a,"[",g,"]");a=b.def(a,"[",e("dst","Alpha"),"]");return[q,g,f,a]});case "blend.equation":return b(function(a){if("string"===typeof a)return[R[a],R[a]];if("object"===typeof a)return[R[a.rgb],R[a.alpha]]},function(a,b,c){var e=a.constants.blendEquations,q=b.def(),g=b.def();a=a.cond("typeof ",c,'==="string"');a.then(q,"=",g,"=",e,"[",c,"];");a["else"](q,"=",e,"[",c,".rgb];",g,"=",e,"[",c,".alpha];");b(a);return[q,g]});
case "blend.color":return b(function(a){return k(4,function(b){return+a[b]})},function(a,b,c){return k(4,function(a){return b.def("+",c,"[",a,"]")})});case "stencil.mask":return b(function(a){return a|0},function(a,b,c){return b.def(c,"|0")});case "stencil.func":return b(function(a){return[A[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,c){a=b.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680);var e=b.def(c,".ref|0");b=b.def('"mask" in ',c,"?",c,".mask|0:-1");return[a,
e,b]});case "stencil.opFront":case "stencil.opBack":return b(function(b){return["stencil.opBack"===a?1029:1028,C[b.fail||"keep"],C[b.zfail||"keep"],C[b.zpass||"keep"]]},function(b,c,e){function q(a){return c.def('"',a,'" in ',e,"?",g,"[",e,".",a,"]:",7680)}var g=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,q("fail"),q("zfail"),q("zpass")]});case "polygonOffset.offset":return b(function(a){return[a.factor|0,a.units|0]},function(a,b,c){a=b.def(c,".factor|0");b=b.def(c,".units|0");return[a,
b]});case "cull.face":return b(function(a){var b=0;"front"===a?b=1028:"back"===a&&(b=1029);return b},function(a,b,c){return b.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return b(function(a){return a},function(a,b,c){return c});case "frontFace":return b(function(a){return D[a]},function(a,b,c){return b.def(c+'==="cw"?2304:2305')});case "colorMask":return b(function(a){return a.map(function(a){return!!a})},function(a,b,c){return k(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return b(function(a){return["value"in
a?a.value:1,!!a.invert]},function(a,b,c){a=b.def('"value" in ',c,"?+",c,".value:1");b=b.def("!!",c,".invert");return[a,b]})}});return f}function pa(a,b){var q=a["static"],g=a.dynamic,f={};Object.keys(q).forEach(function(a){var b=q[a],c;if("number"===typeof b||"boolean"===typeof b)c=e(function(){return b});else if("function"===typeof b){var g=b._reglType;if("texture2d"===g||"textureCube"===g)c=e(function(a){return a.link(b)});else if("framebuffer"===g||"framebufferCube"===g)c=e(function(a){return a.link(b.color[0])})}else w(b)&&
(c=e(function(a){return a.global.def("[",k(b.length,function(a){return b[a]}),"]")}));c.value=b;f[a]=c});Object.keys(g).forEach(function(a){var b=g[a];f[a]=c(b,function(a,c){return a.invoke(c,b)})});return f}function ba(b,q){var g=b["static"],f=b.dynamic,p={};Object.keys(g).forEach(function(b){var c=g[b],q=d.id(b),f=new xa;if(a(c))f.state=1,f.buffer=l.getBuffer(l.create(c,34962,!1,!0)),f.type=0;else{var M=l.getBuffer(c);if(M)f.state=1,f.buffer=M,f.type=0;else if(c.constant){var n=c.constant;f.buffer=
"null";f.state=2;"number"===typeof n?f.x=n:F.forEach(function(a,b){b<n.length&&(f[a]=n[b])})}else{var M=a(c.buffer)?l.getBuffer(l.create(c.buffer,34962,!1,!0)):l.getBuffer(c.buffer),k=c.offset|0,Ca=c.stride|0,h=c.size|0,m=!!c.normalized,u=0;"type"in c&&(u=z[c.type]);c=c.divisor|0;f.buffer=M;f.state=1;f.size=h;f.normalized=m;f.type=u||M.dtype;f.offset=k;f.stride=Ca;f.divisor=c}}p[b]=e(function(a,b){var c=a.attribCache;if(q in c)return c[q];var e={isStream:!1};Object.keys(f).forEach(function(a){e[a]=
f[a]});f.buffer&&(e.buffer=a.link(f.buffer),e.type=e.type||e.buffer+".dtype");return c[q]=e})});Object.keys(f).forEach(function(a){var b=f[a];p[a]=c(b,function(a,c){function e(a){c(M[a],"=",q,".",a,"|0;")}var q=a.invoke(c,b),f=a.shared,g=f.isBufferArgs,p=f.buffer,M={isStream:c.def(!1)},n=new xa;n.state=1;Object.keys(n).forEach(function(a){M[a]=c.def(""+n[a])});var k=M.buffer,d=M.type;c("if(",g,"(",q,")){",M.isStream,"=true;",k,"=",p,".createStream(",34962,",",q,");",d,"=",k,".dtype;","}else{",k,"=",
p,".getBuffer(",q,");","if(",k,"){",d,"=",k,".dtype;",'}else if("constant" in ',q,"){",M.state,"=",2,";","if(typeof "+q+'.constant === "number"){',M[F[0]],"=",q,".constant;",F.slice(1).map(function(a){return M[a]}).join("="),"=0;","}else{",F.map(function(a,b){return M[a]+"="+q+".constant.length>="+b+"?"+q+".constant["+b+"]:0;"}).join(""),"}}else{","if(",g,"(",q,".buffer)){",k,"=",p,".createStream(",34962,",",q,".buffer);","}else{",k,"=",p,".getBuffer(",q,".buffer);","}",d,'="type" in ',q,"?",f.glTypes,
"[",q,".type]:",k,".dtype;",M.normalized,"=!!",q,".normalized;");e("size");e("offset");e("stride");e("divisor");c("}}");c.exit("if(",M.isStream,"){",p,".destroyStream(",k,");","}");return M})});return p}function ia(a){var b=a["static"],q=a.dynamic,f={};Object.keys(b).forEach(function(a){var c=b[a];f[a]=e(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(q).forEach(function(a){var b=q[a];f[a]=c(b,function(a,c){return a.invoke(c,b)})});return f}function ka(a,
b,c,e,q){var f=wa(a,q),g=T(a,f,q),p=ja(a,q),n=oa(a,q),k=ha(a,q),d=g.viewport;d&&(n.viewport=d);d=W("scissor.box");(g=g[d])&&(n[d]=g);g=0<Object.keys(n).length;f={framebuffer:f,draw:p,shader:k,state:n,dirty:g};f.profile=ma(a,q);f.uniforms=pa(c,q);f.attributes=ba(b,q);f.context=ia(e,q);return f}function ca(a,b,c){var e=a.shared.context,q=a.scope();Object.keys(c).forEach(function(f){b.save(e,"."+f);q(e,".",f,"=",c[f].append(a,b),";")});b(q)}function X(a,b,c,e){var q=a.shared,f=q.gl,g=q.framebuffer,p;
ea&&(p=b.def(q.extensions,".webgl_draw_buffers"));var n=a.constants,q=n.drawBuffer,n=n.backBuffer;a=c?c.append(a,b):b.def(g,".next");e||b("if(",a,"!==",g,".cur){");b("if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);");ea&&b(p,".drawBuffersWEBGL(",q,"[",a,".colorAttachments.length]);");b("}else{",f,".bindFramebuffer(",36160,",null);");ea&&b(p,".drawBuffersWEBGL(",n,");");b("}",g,".cur=",a,";");e||b("}")}function fa(a,b,c){var e=a.shared,f=e.gl,g=a.current,p=a.next,n=e.current,d=e.next,
h=a.cond(n,".dirty");E.forEach(function(b){b=W(b);if(!(b in c.state)){var e,Ca;if(b in p){e=p[b];Ca=g[b];var m=k(q[b].length,function(a){return h.def(e,"[",a,"]")});h(a.cond(m.map(function(a,b){return a+"!=="+Ca+"["+b+"]"}).join("||")).then(f,".",va[b],"(",m,");",m.map(function(a,b){return Ca+"["+b+"]="+a}).join(";"),";"))}else e=h.def(d,".",b),m=a.cond(e,"!==",n,".",b),h(m),b in ua?m(a.cond(e).then(f,".enable(",ua[b],");")["else"](f,".disable(",ua[b],");"),n,".",b,"=",e,";"):m(f,".",va[b],"(",e,
");",n,".",b,"=",e,";")}});0===Object.keys(c.state).length&&h(n,".dirty=false;");b(h)}function N(a,c,e,q){var g=a.shared,p=a.current,n=g.current,k=g.gl;b(Object.keys(e)).forEach(function(b){var g=e[b];if(!q||q(g)){var d=g.append(a,c);if(ua[b]){var h=ua[b];f(g)?d?c(k,".enable(",h,");"):c(k,".disable(",h,");"):c(a.cond(d).then(k,".enable(",h,");")["else"](k,".disable(",h,");"));c(n,".",b,"=",d,";")}else if(w(d)){var m=p[b];c(k,".",va[b],"(",d,");",d.map(function(a,b){return m+"["+b+"]="+a}).join(";"),
";")}else c(k,".",va[b],"(",d,");",n,".",b,"=",d,";")}})}function na(a,b){qa&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function U(a,b,c,e,q){function g(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function p(a){v=b.def();a(v,"=",g(),";");"string"===typeof q?a(h,".count+=",q,";"):a(h,".count++;");la&&(e?(w=b.def(),a(w,"=",u,".getNumPendingQueries();")):a(u,".beginQuery(",h,");"))}function n(a){a(h,".cpuTime+=",g(),"-",v,";");la&&(e?a(u,".pushScopeStats(",
w,",",u,".getNumPendingQueries(),",h,");"):a(u,".endQuery();"))}function k(a){var c=b.def(m,".profile");b(m,".profile=",a,";");b.exit(m,".profile=",c,";")}var d=a.shared,h=a.stats,m=d.current,u=d.timer;c=c.profile;var v,w;if(c){if(f(c)){c.enable?(p(b),n(b.exit),k("true")):k("false");return}c=c.append(a,b);k(c)}else c=b.def(m,".profile");d=a.block();p(d);b("if(",c,"){",d,"}");a=a.block();n(a);b.exit("if(",c,"){",a,"}")}function Y(a,b,c,e,q){function f(a){switch(a){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function g(c,e,q){function f(){b("if(!",h,".buffer){",k,".enableVertexAttribArray(",d,");}");var c=q.type,g;g=q.size?b.def(q.size,"||",e):e;b("if(",h,".type!==",c,"||",h,".size!==",g,"||",v.map(function(a){return h+"."+a+"!=="+q[a]}).join("||"),"){",k,".bindBuffer(",34962,",",m,".buffer);",k,".vertexAttribPointer(",[d,g,c,q.normalized,q.stride,q.offset],");",h,".type=",c,";",h,".size=",g,";",v.map(function(a){return h+
"."+a+"="+q[a]+";"}).join(""),"}");qa&&(c=q.divisor,b("if(",h,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[d,c],");",h,".divisor=",c,";}"))}function n(){b("if(",h,".buffer){",k,".disableVertexAttribArray(",d,");","}if(",F.map(function(a,b){return h+"."+a+"!=="+u[b]}).join("||"),"){",k,".vertexAttrib4f(",d,",",u,");",F.map(function(a,b){return h+"."+a+"="+u[b]+";"}).join(""),"}")}var k=p.gl,d=b.def(c,".location"),h=b.def(p.attributes,"[",d,"]");c=q.state;var m=q.buffer,u=[q.x,q.y,
q.z,q.w],v=["buffer","normalized","offset","stride"];1===c?f():2===c?n():(b("if(",c,"===",1,"){"),f(),b("}else{"),n(),b("}"))}var p=a.shared;e.forEach(function(e){var p=e.name,n=c.attributes[p],k;if(n){if(!q(n))return;k=n.append(a,b)}else{if(!q(y))return;var d=a.scopeAttrib(p);k={};Object.keys(new xa).forEach(function(a){k[a]=b.def(d,".",a)})}g(a.link(e),f(e.info.type),k)})}function S(a,b,c,e,q){for(var g=a.shared,p=g.gl,n,h=0;h<e.length;++h){var m=e[h],u=m.name,v=m.info.type,t=c.uniforms[u],m=a.link(m)+
".location",E;if(t){if(!q(t))continue;if(f(t)){u=t.value;if(35678===v||35680===v)v=a.link(u._texture||u.color[0]._texture),b(p,".uniform1i(",m,",",v+".bind());"),b.exit(v,".unbind();");else if(35674===v||35675===v||35676===v)u=a.global.def("new Float32Array(["+Array.prototype.slice.call(u)+"])"),t=2,35675===v?t=3:35676===v&&(t=4),b(p,".uniformMatrix",t,"fv(",m,",false,",u,");");else{switch(v){case 5126:n="1f";break;case 35664:n="2f";break;case 35665:n="3f";break;case 35666:n="4f";break;case 35670:n=
"1i";break;case 5124:n="1i";break;case 35671:n="2i";break;case 35667:n="2i";break;case 35672:n="3i";break;case 35668:n="3i";break;case 35673:n="4i";break;case 35669:n="4i"}b(p,".uniform",n,"(",m,",",w(u)?Array.prototype.slice.call(u):u,");")}continue}else E=t.append(a,b)}else{if(!q(y))continue;E=b.def(g.uniforms,"[",d.id(u),"]")}35678===v?b("if(",E,"&&",E,'._reglType==="framebuffer"){',E,"=",E,".color[0];","}"):35680===v&&b("if(",E,"&&",E,'._reglType==="framebufferCube"){',E,"=",E,".color[0];","}");
u=1;switch(v){case 35678:case 35680:v=b.def(E,"._texture");b(p,".uniform1i(",m,",",v,".bind());");b.exit(v,".unbind();");continue;case 5124:case 35670:n="1i";break;case 35667:case 35671:n="2i";u=2;break;case 35668:case 35672:n="3i";u=3;break;case 35669:case 35673:n="4i";u=4;break;case 5126:n="1f";break;case 35664:n="2f";u=2;break;case 35665:n="3f";u=3;break;case 35666:n="4f";u=4;break;case 35674:n="Matrix2fv";break;case 35675:n="Matrix3fv";break;case 35676:n="Matrix4fv"}b(p,".uniform",n,"(",m,",");
if("M"===n.charAt(0)){var m=Math.pow(v-35674+2,2),x=a.global.def("new Float32Array(",m,")");b("false,(Array.isArray(",E,")||",E," instanceof Float32Array)?",E,":(",k(m,function(a){return x+"["+a+"]="+E+"["+a+"]"}),",",x,")")}else 1<u?b(k(u,function(a){return E+"["+a+"]"})):b(E);b(");")}}function ra(a,b,c,e){function q(f){var g=h[f];return g?g.contextDep&&e.contextDynamic||g.propDep?g.append(a,c):g.append(a,b):b.def(d,".",f)}function g(){function a(){c(t,".drawElementsInstancedANGLE(",[u,E,x,v+"<<(("+
x+"-5121)>>1)",w],");")}function b(){c(t,".drawArraysInstancedANGLE(",[u,v,E,w],");")}m?ta?a():(c("if(",m,"){"),a(),c("}else{"),b(),c("}")):b()}function n(){function a(){c(k+".drawElements("+[u,E,x,v+"<<(("+x+"-5121)>>1)"]+");")}function b(){c(k+".drawArrays("+[u,v,E]+");")}m?ta?a():(c("if(",m,"){"),a(),c("}else{"),b(),c("}")):b()}var p=a.shared,k=p.gl,d=p.draw,h=e.draw,m=function(){var q=h.elements,f=b;if(q){if(q.contextDep&&e.contextDynamic||q.propDep)f=c;q=q.append(a,f)}else q=f.def(d,".","elements");
q&&f("if("+q+")"+k+".bindBuffer(34963,"+q+".buffer.buffer);");return q}(),u=q("primitive"),v=q("offset"),E=function(){var q=h.count,f=b;if(q){if(q.contextDep&&e.contextDynamic||q.propDep)f=c;q=q.append(a,f)}else q=f.def(d,".","count");return q}();if("number"===typeof E){if(0===E)return}else c("if(",E,"){"),c.exit("}");var w,t;qa&&(w=q("instances"),t=a.instancing);var x=m+".type",ta=h.elements&&f(h.elements);qa&&("number"!==typeof w||0<=w)?"string"===typeof w?(c("if(",w,">0){"),g(),c("}else if(",w,
"<0){"),n(),c("}")):g():n()}function Aa(a,b,c,e,q){b=aa();q=b.proc("body",q);qa&&(b.instancing=q.def(b.shared.extensions,".angle_instanced_arrays"));a(b,q,c,e);return b.compile().body}function Ba(a,b,c,e){na(a,b);Y(a,b,c,e.attributes,function(){return!0});S(a,b,c,e.uniforms,function(){return!0});ra(a,b,b,c)}function Da(a,b){var c=a.proc("draw",1);na(a,c);ca(a,c,b.context);X(a,c,b.framebuffer);fa(a,c,b);N(a,c,b.state);U(a,c,b,!1,!0);var e=b.shader.progVar.append(a,c);c(a.shared.gl,".useProgram(",e,
".program);");if(b.shader.program)Ba(a,c,b,b.shader.program);else{var q=a.global.def("{}"),f=c.def(e,".id"),g=c.def(q,"[",f,"]");c(a.cond(g).then(g,".call(this,a0);")["else"](g,"=",q,"[",f,"]=",a.link(function(c){return Aa(Ba,a,b,c,1)}),"(",e,");",g,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Ea(a,b,c,e){function q(){return!0}a.batchId="a1";na(a,b);Y(a,b,c,e.attributes,q);S(a,b,c,e.uniforms,q);ra(a,b,b,c)}function ya(a,b,c,e){function q(a){return a.contextDep&&
g||a.propDep}function f(a){return!q(a)}na(a,b);var g=c.contextDep,n=b.def(),p=b.def();a.shared.props=p;a.batchId=n;var k=a.scope(),d=a.scope();b(k.entry,"for(",n,"=0;",n,"<","a1",";++",n,"){",p,"=","a0","[",n,"];",d,"}",k.exit);c.needsContext&&ca(a,d,c.context);c.needsFramebuffer&&X(a,d,c.framebuffer);N(a,d,c.state,q);c.profile&&q(c.profile)&&U(a,d,c,!1,!0);e?(Y(a,k,c,e.attributes,f),Y(a,d,c,e.attributes,q),S(a,k,c,e.uniforms,f),S(a,d,c,e.uniforms,q),ra(a,k,d,c)):(b=a.global.def("{}"),e=c.shader.progVar.append(a,
d),p=d.def(e,".id"),k=d.def(b,"[",p,"]"),d(a.shared.gl,".useProgram(",e,".program);","if(!",k,"){",k,"=",b,"[",p,"]=",a.link(function(b){return Aa(Ea,a,c,b,2)}),"(",e,");}",k,".call(this,a0[",n,"],",n,");"))}function za(a,b){function c(a){return a.contextDep&&q||a.propDep}var e=a.proc("batch",2);a.batchId="0";na(a,e);var q=!1,f=!0;Object.keys(b.context).forEach(function(a){q=q||b.context[a].propDep});q||(ca(a,e,b.context),f=!1);var g=b.framebuffer,n=!1;g?(g.propDep?q=n=!0:g.contextDep&&q&&(n=!0),
n||X(a,e,g)):X(a,e,null);b.state.viewport&&b.state.viewport.propDep&&(q=!0);fa(a,e,b);N(a,e,b.state,function(a){return!c(a)});b.profile&&c(b.profile)||U(a,e,b,!1,"a1");b.contextDep=q;b.needsContext=f;b.needsFramebuffer=n;f=b.shader.progVar;if(f.contextDep&&q||f.propDep)ya(a,e,b,null);else if(f=f.append(a,e),e(a.shared.gl,".useProgram(",f,".program);"),b.shader.program)ya(a,e,b,b.shader.program);else{var g=a.global.def("{}"),n=e.def(f,".id"),p=e.def(g,"[",n,"]");e(a.cond(p).then(p,".call(this,a0,a1);")["else"](p,
"=",g,"[",n,"]=",a.link(function(c){return Aa(ya,a,b,c,2)}),"(",f,");",p,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&e(a.shared.current,".dirty=true;")}function Ja(a,c){function e(b){var g=c.shader[b];g&&q.set(f.shader,"."+b,g.append(a,q))}var q=a.proc("scope",3);a.batchId="a2";var f=a.shared,g=f.current;ca(a,q,c.context);c.framebuffer&&c.framebuffer.append(a,q);b(Object.keys(c.state)).forEach(function(b){var e=c.state[b].append(a,q);w(e)?e.forEach(function(c,e){q.set(a.next[b],"["+e+"]",
c)}):q.set(f.next,"."+b,e)});U(a,q,c,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var e=c.draw[b];e&&q.set(f.draw,"."+b,""+e.append(a,q))});Object.keys(c.uniforms).forEach(function(b){q.set(f.uniforms,"["+d.id(b)+"]",c.uniforms[b].append(a,q))});Object.keys(c.attributes).forEach(function(b){var e=c.attributes[b].append(a,q),f=a.scopeAttrib(b);Object.keys(new xa).forEach(function(a){q.set(f,"."+a,e[a])})});e("vert");e("frag");0<Object.keys(c.state).length&&(q(g,
".dirty=true;"),q.exit(g,".dirty=true;"));q("a1(",a.shared.context,",a0,",a.batchId,");")}function Ha(a){if("object"===typeof a&&!w(a)){for(var b=Object.keys(a),c=0;c<b.length;++c)if(m.isDynamic(a[b[c]]))return!0;return!1}}function Fa(a,b,e){function q(a,b){n.forEach(function(c){var e=f[c];m.isDynamic(e)&&(e=a.invoke(b,e),b(h,".",c,"=",e,";"))})}var f=b["static"][e];if(f&&Ha(f)){var g=a.global,n=Object.keys(f),p=!1,k=!1,d=!1,h=a.global.def("{}");n.forEach(function(b){var e=f[b];if(m.isDynamic(e))"function"===
typeof e&&(e=f[b]=m.unbox(e)),b=c(e,null),p=p||b.thisDep,d=d||b.propDep,k=k||b.contextDep;else{g(h,".",b,"=");switch(typeof e){case "number":g(e);break;case "string":g('"',e,'"');break;case "object":Array.isArray(e)&&g("[",e.join(),"]");break;default:g(a.link(e))}g(";")}});b.dynamic[e]=new m.DynamicVariable(4,{thisDep:p,contextDep:k,propDep:d,ref:h,append:q});delete b["static"][e]}}var xa=G.Record,R={add:32774,subtract:32778,"reverse subtract":32779};h.ext_blend_minmax&&(R.min=32775,R.max=32776);
var qa=h.angle_instanced_arrays,ea=h.webgl_draw_buffers,q={dirty:!0,profile:da.profile},ta={},E=[],ua={},va={};P("dither",3024);P("blend.enable",3042);I("blend.color","blendColor",[0,0,0,0]);I("blend.equation","blendEquationSeparate",[32774,32774]);I("blend.func","blendFuncSeparate",[1,0,1,0]);P("depth.enable",2929,!0);I("depth.func","depthFunc",513);I("depth.range","depthRange",[0,1]);I("depth.mask","depthMask",!0);I("colorMask","colorMask",[!0,!0,!0,!0]);P("cull.enable",2884);I("cull.face","cullFace",
1029);I("frontFace","frontFace",2305);I("lineWidth","lineWidth",1);P("polygonOffset.enable",32823);I("polygonOffset.offset","polygonOffset",[0,0]);P("sample.alpha",32926);P("sample.enable",32928);I("sample.coverage","sampleCoverage",[1,!1]);P("stencil.enable",2960);I("stencil.mask","stencilMask",-1);I("stencil.func","stencilFunc",[519,0,-1]);I("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);I("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);P("scissor.enable",3089);I("scissor.box",
"scissor",[0,0,n.drawingBufferWidth,n.drawingBufferHeight]);I("viewport","viewport",[0,0,n.drawingBufferWidth,n.drawingBufferHeight]);var Ka={gl:n,context:ga,strings:d,next:ta,current:q,draw:H,elements:r,buffer:l,shader:sa,attributes:G.state,uniforms:K,framebuffer:B,extensions:h,timer:la,isBufferArgs:a},Ga={primTypes:t,compareFuncs:A,blendFuncs:u,blendEquations:R,stencilOps:C,glTypes:z,orientationType:D};ea&&(Ga.backBuffer=[1029],Ga.drawBuffer=k(v.maxDrawbuffers,function(a){return 0===a?[0]:k(a,function(a){return 36064+
a})}));var Ma=0;return{next:ta,current:q,procs:function(){var a=aa(),b=a.proc("poll"),c=a.proc("refresh"),e=a.block();b(e);c(e);var f=a.shared,g=f.gl,p=f.next,d=f.current;e(d,".dirty=false;");X(a,b);X(a,c,null,!0);var h=n.getExtension("angle_instanced_arrays"),m;h&&(m=a.link(h));for(var u=0;u<v.maxAttributes;++u){var E=c.def(f.attributes,"[",u,"]"),t=a.cond(E,".buffer");t.then(g,".enableVertexAttribArray(",u,");",g,".bindBuffer(",34962,",",E,".buffer.buffer);",g,".vertexAttribPointer(",u,",",E,".size,",
E,".type,",E,".normalized,",E,".stride,",E,".offset);")["else"](g,".disableVertexAttribArray(",u,");",g,".vertexAttrib4f(",u,",",E,".x,",E,".y,",E,".z,",E,".w);",E,".buffer=null;");c(t);h&&c(m,".vertexAttribDivisorANGLE(",u,",",E,".divisor);")}Object.keys(ua).forEach(function(q){var f=ua[q],n=e.def(p,".",q),k=a.block();k("if(",n,"){",g,".enable(",f,")}else{",g,".disable(",f,")}",d,".",q,"=",n,";");c(k);b("if(",n,"!==",d,".",q,"){",k,"}")});Object.keys(va).forEach(function(f){var n=va[f],h=q[f],m,
u,v=a.block();v(g,".",n,"(");w(h)?(n=h.length,m=a.global.def(p,".",f),u=a.global.def(d,".",f),v(k(n,function(a){return m+"["+a+"]"}),");",k(n,function(a){return u+"["+a+"]="+m+"["+a+"];"}).join("")),b("if(",k(n,function(a){return m+"["+a+"]!=="+u+"["+a+"]"}).join("||"),"){",v,"}")):(m=e.def(p,".",f),u=e.def(d,".",f),v(m,");",d,".",f,"=",m,";"),b("if(",m,"!==",u,"){",v,"}"));c(v)});return a.compile()}(),compile:function(a,b,c,e,q){var f=aa();f.stats=f.link(q);Object.keys(b["static"]).forEach(function(a){Fa(f,
b,a)});x.forEach(function(b){Fa(f,a,b)});c=ka(a,b,c,e,f);Da(f,c);Ja(f,c);za(f,c);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/loop":28}],9:[function(d,l,r){function a(a,b){this.id=f++;this.type=a;this.data=b}function b(a){if(0===a.length)return[];var c=a.charAt(0),f=a.charAt(a.length-1);if(1<a.length&&c===f&&('"'===c||"'"===c))return['"'+a.substr(1,
a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(c=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return b(a.substr(0,c.index)).concat(b(c[1])).concat(b(a.substr(c.index+c[0].length)));c=a.split(".");if(1===c.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(f=0;f<c.length;++f)a=a.concat(b(c[f]));return a}function p(a){return"["+b(a).join("][")+"]"}var f=0;l.exports={DynamicVariable:a,define:function(b,c){return new a(b,p(c+""))},isDynamic:function(b){return"function"===
typeof b&&!b._reglType||b instanceof a},unbox:function(b,c){return"function"===typeof b?new a(0,b):b},accessor:p}},{}],10:[function(d,l,r){var a=d("./util/is-typed-array"),b=d("./util/is-ndarray"),p=d("./util/values"),f=d("./constants/primitives.json"),e=d("./constants/usage.json");l.exports=function(c,g,k,d){function h(a){this.id=z++;t[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function w(c,e,f,p,d,n,h){(n=h)||a(e)&&(!b(e)||a(e.data))||(n=g.oes_element_index_uint?5125:
5123);c.buffer.bind();k._initBuffer(c.buffer,e,f,n,3);e=h;if(!h){switch(c.buffer.dtype){case 5121:case 5120:e=5121;break;case 5123:case 5122:e=5123;break;case 5125:case 5124:e=5125}c.buffer.dtype=e}c.type=e;0>d&&(d=c.buffer.byteLength,5123===e?d>>=1:5125===e&&(d>>=2));c.vertCount=d;d=p;0>p&&(d=4,p=c.buffer.dimension,1===p&&(d=0),2===p&&(d=1),3===p&&(d=4));c.primType=d}function m(a){d.elementsCount--;delete t[a.id];a.buffer.destroy();a.buffer=null}var t={},z=0,l={uint8:5121,uint16:5123};g.oes_element_index_uint&&
(l.uint32=5125);h.prototype.bind=function(){this.buffer.bind()};var x=[];return{create:function(g,p){function t(g){if(g)if("number"===typeof g)x(g),z.primType=4,z.vertCount=g|0,z.type=5121;else{var p=null,d=35044,k=-1,h=-1,m=0,u=0;Array.isArray(g)||a(g)||b(g)?p=g:("data"in g&&(p=g.data),"usage"in g&&(d=e[g.usage]),"primitive"in g&&(k=f[g.primitive]),"count"in g&&(h=g.count|0),"length"in g&&(m=g.length|0),"type"in g&&(u=l[g.type]));p?w(z,p,d,k,h,m,u):(g=z.buffer,g.bind(),c.bufferData(34963,m,d),g.dtype=
u||5121,g.usage=d,g.dimension=3,g.byteLength=m,z.primType=0>k?4:k,z.vertCount=0>h?0:h,z.type=g.dtype)}else x(),z.primType=4,z.vertCount=0,z.type=5121;return t}var x=k.create(null,34963,!0),z=new h(x._buffer);d.elementsCount++;t(g);t._reglType="elements";t._elements=z;t.subdata=function(a,b){x.subdata(a,b);return t};t.destroy=function(){m(z)};return t},createStream:function(a){var b=x.pop();b||(b=new h(k.create(null,34963,!0,!1)._buffer));w(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){x.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof h?a._elements:null},clear:function(){p(t).forEach(m)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/values":32}],11:[function(d,l,r){l.exports=function(a,b){function p(b){b=b.toLowerCase();var c;try{c=f[b]=a.getExtension(b)}catch(e){}return!!c}for(var f={},e=0;e<b.extensions.length;++e){var c=b.extensions[e];if(!p(c))return b.onDestroy(),b.onDone('"'+
c+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}b.optionalExtensions.forEach(p);return{extensions:f,restore:function(){Object.keys(f).forEach(function(a){if(!p(a))throw Error("(regl): error restoring extension "+a);})}}}},{}],12:[function(d,l,r){var a=d("./util/values"),b=d("./util/extend"),p=[];p[6408]=4;var f=[];f[5121]=1;f[5126]=4;f[36193]=2;l.exports=function(e,c,g,d,v,h){function w(a,b,c){this.target=a;this.texture=b;this.renderbuffer=
c;var e=a=0;b?(a=b.width,e=b.height):c&&(a=c.width,e=c.height);this.width=a;this.height=e}function m(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function t(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function z(a,b){b?b.texture?e.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):e.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):e.framebufferTexture2D(36160,
a,3553,null,0)}function l(a){var b=3553,c=null,e=null,f=a;"object"===typeof a&&(f=a.data,"target"in a&&(b=a.target|0));a=f._reglType;"texture2d"===a?c=f:"textureCube"===a?c=f:"renderbuffer"===a&&(e=f,b=36161);return new w(b,c,e)}function x(a,b,c,e,f){if(c)return a=d.create2D({width:a,height:b,format:e,type:f}),a._texture.refCount=0,new w(3553,a,null);a=v.create({width:a,height:b,format:e});a._renderbuffer.refCount=0;return new w(36161,null,a)}function u(a){return a&&(a.texture||a.renderbuffer)}function A(a,
b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function r(){this.id=O++;B[this.id]=this;this.framebuffer=e.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function D(a){a.colorAttachments.forEach(m);m(a.depthAttachment);m(a.stencilAttachment);m(a.depthStencilAttachment)}function y(a){e.deleteFramebuffer(a.framebuffer);a.framebuffer=null;h.framebufferCount--;delete B[a.id]}
function n(a){var b;e.bindFramebuffer(36160,a.framebuffer);var c=a.colorAttachments;for(b=0;b<c.length;++b)z(36064+b,c[b]);for(b=c.length;b<g.maxColorAttachments;++b)z(36064+b,null);z(36096,a.depthAttachment);z(36128,a.stencilAttachment);z(33306,a.depthStencilAttachment);e.checkFramebufferStatus(36160);e.bindFramebuffer(36160,J.next);J.cur=J.next;e.getError()}function L(a,c){function e(a,b){var c,d=0,k=0,h=!0,m=!0;c=null;var v=!0,w="rgba",z="uint8",A=1,y=null,r=null,C=null,L=!1;if("number"===typeof a)d=
a|0,k=b|0||d;else if(a){"shape"in a?(k=a.shape,d=k[0],k=k[1]):("radius"in a&&(d=k=a.radius),"width"in a&&(d=a.width),"height"in a&&(k=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);if(!c){"colorCount"in a&&(A=a.colorCount|0);"colorTexture"in a&&(v=!!a.colorTexture,w="rgba4");if("colorType"in a&&(z=a.colorType,!v))if("half float"===z||"float16"===z)w="rgba16f";else if("float"===z||"float32"===z)w="rgba32f";"colorFormat"in a&&(w=a.colorFormat,0<=Z.indexOf(w)?v=!0:0<=Q.indexOf(w)&&
(v=!1))}if("depthTexture"in a||"depthStencilTexture"in a)L=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?h=a.depth:(y=a.depth,m=!1));"stencil"in a&&("boolean"===typeof a.stencil?m=a.stencil:(r=a.stencil,h=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?h=m=a.depthStencil:(C=a.depthStencil,m=h=!1))}else d=k=1;var B=null,G=null,J=null,K=null;if(Array.isArray(c))B=c.map(l);else if(c)B=[l(c)];else for(B=Array(A),c=0;c<A;++c)B[c]=x(d,k,v,w,z);d=d||B[0].width;
k=k||B[0].height;y?G=l(y):h&&!m&&(G=x(d,k,L,"depth","uint32"));r?J=l(r):m&&!h&&(J=x(d,k,!1,"stencil","uint8"));C?K=l(C):!y&&!r&&m&&h&&(K=x(d,k,L,"depth stencil","depth stencil"));h=null;for(c=0;c<B.length;++c)t(B[c],d,k),B[c]&&B[c].texture&&(m=p[B[c].texture._texture.format]*f[B[c].texture._texture.type],null===h&&(h=m));t(G,d,k);t(J,d,k);t(K,d,k);D(g);g.width=d;g.height=k;g.colorAttachments=B;g.depthAttachment=G;g.stencilAttachment=J;g.depthStencilAttachment=K;e.color=B.map(u);e.depth=u(G);e.stencil=
u(J);e.depthStencil=u(K);e.width=g.width;e.height=g.height;n(g);return e}var g=new r;h.framebufferCount++;e(a,c);return b(e,{resize:function(a,b){var c=a|0,f=b|0||c;if(c===g.width&&f===g.height)return e;for(var p=g.colorAttachments,d=0;d<p.length;++d)A(p[d],c,f);A(g.depthAttachment,c,f);A(g.stencilAttachment,c,f);A(g.depthStencilAttachment,c,f);g.width=e.width=c;g.height=e.height=f;n(g);return e},_reglType:"framebuffer",_framebuffer:g,destroy:function(){y(g);D(g)}})}var J={cur:null,next:null,dirty:!1},
Z=["rgba"],Q=["rgba4","rgb565","rgb5 a1"];c.ext_srgb&&Q.push("srgba");c.ext_color_buffer_half_float&&Q.push("rgba16f","rgb16f");c.webgl_color_buffer_float&&Q.push("rgba32f");var V=["uint8"];c.oes_texture_half_float&&V.push("half float","float16");c.oes_texture_float&&V.push("float","float32");var O=0,B={};return b(J,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof r)?a:null},create:L,createCube:function(a){function c(a){var f,g={color:null},
p=0,n=null;f="rgba";var h="uint8",m=1;if("number"===typeof a)p=a|0;else if(a){"shape"in a?p=a.shape[0]:("radius"in a&&(p=a.radius|0),"width"in a?p=a.width|0:"height"in a&&(p=a.height|0));if("color"in a||"colors"in a)n=a.color||a.colors,Array.isArray(n);n||("colorCount"in a&&(m=a.colorCount|0),"colorType"in a&&(h=a.colorType),"colorFormat"in a&&(f=a.colorFormat));"depth"in a&&(g.depth=a.depth);"stencil"in a&&(g.stencil=a.stencil);"depthStencil"in a&&(g.depthStencil=a.depthStencil)}else p=1;if(n)if(Array.isArray(n))for(a=
[],f=0;f<n.length;++f)a[f]=n[f];else a=[n];else for(a=Array(m),n={radius:p,format:f,type:h},f=0;f<m;++f)a[f]=d.createCube(n);g.color=Array(a.length);for(f=0;f<a.length;++f)m=a[f],p=p||m.width,g.color[f]={target:34069,data:a[f]};for(f=0;6>f;++f){for(m=0;m<a.length;++m)g.color[m].target=34069+f;0<f&&(g.depth=e[0].depth,g.stencil=e[0].stencil,g.depthStencil=e[0].depthStencil);if(e[f])e[f](g);else e[f]=L(g)}return b(c,{width:p,height:p,color:a})}var e=Array(6);c(a);return b(c,{faces:e,resize:function(a){var b=
a|0;if(b===c.width)return c;var f=c.color;for(a=0;a<f.length;++a)f[a].resize(b);for(a=0;6>a;++a)e[a].resize(b);c.width=c.height=b;return c},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},clear:function(){a(B).forEach(y)},restore:function(){a(B).forEach(function(a){a.framebuffer=e.createFramebuffer();n(a)})}})}},{"./util/extend":23,"./util/values":32}],13:[function(d,l,r){l.exports=function(a,b){var p=1;b.ext_texture_filter_anisotropic&&(p=a.getParameter(34047));
var f=1,e=1;b.webgl_draw_buffers&&(f=a.getParameter(34852),e=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:p,maxDrawbuffers:f,maxColorAttachments:e,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),
maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},
{}],14:[function(d,l,r){var a=d("./util/is-typed-array");l.exports=function(b,p,f,e,c,g){return function(c){var g;g=null===p.next?5121:p.next.colorAttachments[0].texture._texture.type;var d=0,w=0,m=e.framebufferWidth,t=e.framebufferHeight,z=null;a(c)?z=c:c&&(d=c.x|0,w=c.y|0,m=(c.width||e.framebufferWidth-d)|0,t=(c.height||e.framebufferHeight-w)|0,z=c.data||null);f();c=m*t*4;z||(5121===g?z=new Uint8Array(c):5126===g&&(z=z||new Float32Array(c)));b.pixelStorei(3333,4);b.readPixels(d,w,m,t,6408,g,z);
return z}}},{"./util/is-typed-array":27}],15:[function(d,l,r){var a=d("./util/values"),b=[];b[32854]=2;b[32855]=2;b[36194]=2;b[33189]=2;b[36168]=1;b[34041]=4;b[35907]=4;b[34836]=16;b[34842]=8;b[34843]=6;l.exports=function(p,f,e,c,g){function d(a){this.id=m++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;g.profile&&(this.stats={size:0})}function v(a){var b=a.renderbuffer;p.bindRenderbuffer(36161,null);p.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete t[a.id];
c.renderbufferCount--}var h={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};f.ext_srgb&&(h.srgba=35907);f.ext_color_buffer_half_float&&(h.rgba16f=34842,h.rgb16f=34843);f.webgl_color_buffer_float&&(h.rgba32f=34836);var w=[];Object.keys(h).forEach(function(a){w[h[a]]=a});var m=0,t={};d.prototype.decRef=function(){0>=--this.refCount&&v(this)};g.profile&&(c.getTotalRenderbufferSize=function(){var a=0;Object.keys(t).forEach(function(b){a+=t[b].stats.size});return a});
return{create:function(a,e){function f(a,c){var e=0,d=0,n=32854;"object"===typeof a&&a?("shape"in a?(d=a.shape,e=d[0]|0,d=d[1]|0):("radius"in a&&(e=d=a.radius|0),"width"in a&&(e=a.width|0),"height"in a&&(d=a.height|0)),"format"in a&&(n=h[a.format])):"number"===typeof a?(e=a|0,d="number"===typeof c?c|0:e):a||(e=d=1);if(e!==m.width||d!==m.height||n!==m.format)return f.width=m.width=e,f.height=m.height=d,m.format=n,p.bindRenderbuffer(36161,m.renderbuffer),p.renderbufferStorage(36161,n,e,d),g.profile&&
(m.stats.size=b[m.format]*m.width*m.height),f.format=w[m.format],f}var m=new d(p.createRenderbuffer());t[m.id]=m;c.renderbufferCount++;f(a,e);f.resize=function(a,c){var e=a|0,d=c|0||e;if(e===m.width&&d===m.height)return f;f.width=m.width=e;f.height=m.height=d;p.bindRenderbuffer(36161,m.renderbuffer);p.renderbufferStorage(36161,m.format,e,d);g.profile&&(m.stats.size=b[m.format]*m.width*m.height);return f};f._reglType="renderbuffer";f._renderbuffer=m;g.profile&&(f.stats=m.stats);f.destroy=function(){m.decRef()};
return f},clear:function(){a(t).forEach(v)},restore:function(){a(t).forEach(function(a){a.renderbuffer=p.createRenderbuffer();p.bindRenderbuffer(36161,a.renderbuffer);p.renderbufferStorage(36161,a.format,a.width,a.height)});p.bindRenderbuffer(36161,null)}}}},{"./util/values":32}],16:[function(d,l,r){var a=d("./util/values");l.exports=function(b,d,f,e){function c(a,b,c,e){this.name=a;this.id=b;this.location=c;this.info=e}function g(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;
return}a.push(b)}function k(a,c,e){e=35632===a?w:m;var f=e[c];if(!f){var g=d.str(c),f=b.createShader(a);b.shaderSource(f,g);b.compileShader(f);e[c]=f}return f}function v(a,b){this.id=r++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];e.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function h(a,f){var m,h;m=k(35632,a.fragId);h=k(35633,a.vertId);var v=a.program=b.createProgram();b.attachShader(v,m);b.attachShader(v,h);b.linkProgram(v);var w=b.getProgramParameter(v,
35718);e.profile&&(a.stats.uniformsCount=w);var n=a.uniforms;for(m=0;m<w;++m)if(h=b.getActiveUniform(v,m))if(1<h.size)for(var t=0;t<h.size;++t){var l=h.name.replace("[0]","["+t+"]");g(n,new c(l,d.id(l),b.getUniformLocation(v,l),h))}else g(n,new c(h.name,d.id(h.name),b.getUniformLocation(v,h.name),h));w=b.getProgramParameter(v,35721);e.profile&&(a.stats.attributesCount=w);n=a.attributes;for(m=0;m<w;++m)(h=b.getActiveAttrib(v,m))&&g(n,new c(h.name,d.id(h.name),b.getAttribLocation(v,h.name),h))}var w=
{},m={},t={},l=[],r=0;e.profile&&(f.getMaxUniformsCount=function(){var a=0;l.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)});return a},f.getMaxAttributesCount=function(){var a=0;l.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});return{clear:function(){var c=b.deleteShader.bind(b);a(w).forEach(c);w={};a(m).forEach(c);m={};l.forEach(function(a){b.deleteProgram(a.program)});l.length=0;t={};f.shaderCount=0},program:function(a,b,c){f.shaderCount++;
var e=t[b];e||(e=t[b]={});var g=e[a];g||(g=new v(b,a),h(g,c),e[a]=g,l.push(g));return g},restore:function(){w={};m={};for(var a=0;a<l.length;++a)h(l[a])},shader:k,frag:-1,vert:-1}}},{"./util/values":32}],17:[function(d,l,r){l.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(d,l,r){l.exports=function(){var a={"":0},b=[""];return{id:function(d){var f=a[d];if(f)return f;f=a[d]=
b.length;b.push(d);return f},str:function(a){return b[a]}}}},{}],19:[function(d,l,r){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){return Array.isArray(a)&&0!==a.length&&t(a[0])?!0:!1}function p(a){return Object.prototype.toString.call(a)}function f(c){if(!c)return!1;var e=p(c);return 0<=C.indexOf(e)?!0:a(c)||b(c)||h(c)}function e(a,b){36193===a.type?(a.data=m(b),w.freeType(b)):a.data=b}function c(a,b,c,e,f,g){a="undefined"!==typeof y[a]?y[a]:A[a]*D[b];
g&&(a*=6);if(f){for(e=0;1<=c;)e+=a*c*c,c/=2;return e}return a*c*e}var g=d("./util/extend"),k=d("./util/values"),v=d("./util/is-typed-array"),h=d("./util/is-ndarray"),w=d("./util/pool"),m=d("./util/to-half-float"),t=d("./util/is-array-like"),z=d("./util/flatten");r=d("./constants/arraytypes.json");var F=d("./constants/arraytypes.json"),x=[9984,9986,9985,9987],u=[0,6409,6410,6407,6408],A={};A[6409]=A[6406]=A[6402]=1;A[34041]=A[6410]=2;A[6407]=A[35904]=3;A[6408]=A[35906]=4;var C=Object.keys(r).concat(["[object HTMLCanvasElement]",
"[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),D=[];D[5121]=1;D[5126]=4;D[36193]=2;D[5123]=2;D[5125]=4;var y=[];y[32854]=2;y[32855]=2;y[36194]=2;y[34041]=4;y[33776]=.5;y[33777]=.5;y[33778]=1;y[33779]=1;y[35986]=.5;y[35987]=1;y[34798]=1;y[35840]=.5;y[35841]=.25;y[35842]=.5;y[35843]=.25;y[36196]=.5;l.exports=function(d,l,r,y,D,C,O){function B(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=
1;this.channels=this.height=this.width=this.colorSpace=0}function K(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function G(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=
b.alignment);"colorSpace"in b&&(a.colorSpace=na[b.colorSpace]);"type"in b&&(a.type=U[b.type]);var c=a.width,e=a.height,f=a.channels,g=!1;"shape"in b?(c=b.shape[0],e=b.shape[1],3===b.shape.length&&(f=b.shape[2],g=!0)):("radius"in b&&(c=e=b.radius),"width"in b&&(c=b.width),"height"in b&&(e=b.height),"channels"in b&&(f=b.channels,g=!0));a.width=c|0;a.height=e|0;a.channels=f|0;c=!1;"format"in b&&(c=b.format,e=a.internalformat=Y[c],a.format=Ja[e],c in U&&!("type"in b)&&(a.type=U[c]),c in S&&(a.compressed=
!0),c=!0);!g&&c?a.channels=A[a.format]:g&&!c&&a.channels!==u[a.format]&&(a.format=a.internalformat=u[a.channels])}}function sa(a){d.pixelStorei(37440,a.flipY);d.pixelStorei(37441,a.premultiplyAlpha);d.pixelStorei(37443,a.colorSpace);d.pixelStorei(3317,a.unpackAlignment)}function H(){B.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function ga(c,g){var d=null;f(g)?d=g:g&&(G(c,g),"x"in g&&(c.xOffset=g.x|0),"y"in g&&(c.yOffset=g.y|0),f(g.data)&&
(d=g.data));if(g.copy){var k=D.viewportWidth,n=D.viewportHeight;c.width=c.width||k-c.xOffset;c.height=c.height||n-c.yOffset;c.needsCopy=!0}else if(!d)c.width=c.width||1,c.height=c.height||1,c.channels=c.channels||4;else if(v(d))c.channels=c.channels||4,c.data=d,"type"in g||5121!==c.type||(c.type=F[Object.prototype.toString.call(d)]|0);else if(a(d)){c.channels=c.channels||4;k=d;n=k.length;switch(c.type){case 5121:case 5123:case 5125:case 5126:n=w.allocType(c.type,n);n.set(k);c.data=n;break;case 36193:c.data=
m(k)}c.alignment=1;c.needsFree=!0}else if(h(d)){k=d.data;Array.isArray(k)||5121!==c.type||(c.type=F[Object.prototype.toString.call(k)]|0);var n=d.shape,l=d.stride,x,r,y,A;3===n.length?(y=n[2],A=l[2]):A=y=1;x=n[0];r=n[1];n=l[0];l=l[1];c.alignment=1;c.width=x;c.height=r;c.channels=y;c.format=c.internalformat=u[y];c.needsFree=!0;x=A;d=d.offset;y=c.width;A=c.height;r=c.channels;for(var B=w.allocType(36193===c.type?5126:c.type,y*A*r),C=0,ra=0;ra<A;++ra)for(var R=0;R<y;++R)for(var ea=0;ea<r;++ea)B[C++]=
k[n*R+l*ra+x*ea+d];e(c,B)}else if("[object HTMLCanvasElement]"===p(d)||"[object CanvasRenderingContext2D]"===p(d))"[object HTMLCanvasElement]"===p(d)?c.element=d:c.element=d.canvas,c.width=c.element.width,c.height=c.element.height,c.channels=4;else if("[object HTMLImageElement]"===p(d))c.element=d,c.width=d.naturalWidth,c.height=d.naturalHeight,c.channels=4;else if("[object HTMLVideoElement]"===p(d))c.element=d,c.width=d.videoWidth,c.height=d.videoHeight,c.channels=4;else if(b(d)){k=c.width||d[0].length;
n=c.height||d.length;l=c.channels;l=t(d[0][0])?l||d[0][0].length:l||1;x=z.shape(d);y=1;for(A=0;A<x.length;++A)y*=x[A];y=w.allocType(36193===c.type?5126:c.type,y);z.flatten(d,x,"",y);e(c,y);c.alignment=1;c.width=k;c.height=n;c.channels=l;c.format=c.internalformat=u[l];c.needsFree=!0}}function la(a,b,c,e,f){var g=a.element,p=a.data,k=a.internalformat,m=a.format,h=a.type,v=a.width,w=a.height;sa(a);g?d.texSubImage2D(b,f,c,e,m,h,g):a.compressed?d.compressedTexSubImage2D(b,f,c,e,k,v,w,p):a.needsCopy?(y(),
d.copyTexSubImage2D(b,f,c,e,a.xOffset,a.yOffset,v,w)):d.texSubImage2D(b,f,c,e,v,w,m,h,p)}function da(){return Ha.pop()||new H}function W(a){a.needsFree&&w.freeType(a.data);H.call(a);Ha.push(a)}function P(){B.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function I(a,b,c){var e=a.images[0]=da();a.mipmask=1;e.width=a.width=b;e.height=a.height=c;e.channels=a.channels=4}function aa(a,b){var c=null;if(f(b))c=a.images[0]=da(),K(c,a),ga(c,b),a.mipmask=1;else if(G(a,
b),Array.isArray(b.mipmap))for(var e=b.mipmap,g=0;g<e.length;++g)c=a.images[g]=da(),K(c,a),c.width>>=g,c.height>>=g,ga(c,e[g]),a.mipmask|=1<<g;else c=a.images[0]=da(),K(c,a),ga(c,b),a.mipmask=1;K(a,a.images[0])}function ma(a,b){for(var c=a.images,e=0;e<c.length&&c[e];++e){var f=c[e],g=b,p=e,k=f.element,m=f.data,h=f.internalformat,v=f.format,w=f.type,t=f.width,l=f.height;sa(f);k?d.texImage2D(g,p,v,v,w,k):f.compressed?d.compressedTexImage2D(g,p,h,t,l,0,m):f.needsCopy?(y(),d.copyTexImage2D(g,p,v,f.xOffset,
f.yOffset,t,l,0)):d.texImage2D(g,p,v,t,l,0,v,w,m)}}function wa(){var a=Fa.pop()||new P;B.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function T(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&W(b[c]),b[c]=null;Fa.push(a)}function ha(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ja(a,b){"min"in b&&(a.minFilter=N[b.min],0<=x.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=fa[b.mag]);
var c=a.wrapS,e=a.wrapT;if("wrap"in b){var f=b.wrap;"string"===typeof f?c=e=X[f]:Array.isArray(f)&&(c=X[f[0]],e=X[f[1]])}else"wrapS"in b&&(c=X[b.wrapS]),"wrapT"in b&&(e=X[b.wrapT]);a.wrapS=c;a.wrapT=e;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=ca[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function oa(a,b){d.texParameteri(b,
10241,a.minFilter);d.texParameteri(b,10240,a.magFilter);d.texParameteri(b,10242,a.wrapS);d.texParameteri(b,10243,a.wrapT);l.ext_texture_filter_anisotropic&&d.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(d.hint(33170,a.mipmapHint),d.generateMipmap(b))}function pa(a){B.call(this);this.mipmask=0;this.internalformat=6408;this.id=xa++;this.refCount=1;this.target=a;this.texture=d.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new ha;O.profile&&(this.stats={size:0})}function ba(a){d.activeTexture(33984);
d.bindTexture(a.target,a.texture)}function ia(){var a=ea[0];a?d.bindTexture(a.target,a.texture):d.bindTexture(3553,null)}function ka(a){var b=a.texture,c=a.unit,e=a.target;0<=c&&(d.activeTexture(33984+c),d.bindTexture(e,null),ea[c]=null);d.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete R[a.id];C.textureCount--}var ca={"don't care":4352,"dont care":4352,nice:4354,fast:4353},X={repeat:10497,clamp:33071,mirror:33648},fa={nearest:9728,linear:9729},N=g({mipmap:9987,"nearest mipmap nearest":9984,
"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},fa),na={none:0,browser:37444},U={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},S={};l.ext_srgb&&(Y.srgb=35904,Y.srgba=35906);l.oes_texture_float&&(U.float32=U["float"]=5126);l.oes_texture_half_float&&(U.float16=U["half float"]=36193);l.webgl_depth_texture&&(g(Y,{depth:6402,"depth stencil":34041}),
g(U,{uint16:5123,uint32:5125,"depth stencil":34042}));l.webgl_compressed_texture_s3tc&&g(S,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});l.webgl_compressed_texture_atc&&g(S,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});l.webgl_compressed_texture_pvrtc&&g(S,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});l.webgl_compressed_texture_etc1&&(S["rgb etc1"]=36196);
var ra=Array.prototype.slice.call(d.getParameter(34467));Object.keys(S).forEach(function(a){var b=S[a];0<=ra.indexOf(b)&&(Y[a]=b)});var Aa=Object.keys(Y);r.textureFormats=Aa;var Ba=[];Object.keys(Y).forEach(function(a){Ba[Y[a]]=a});var Da=[];Object.keys(U).forEach(function(a){Da[U[a]]=a});var Ea=[];Object.keys(fa).forEach(function(a){Ea[fa[a]]=a});var ya=[];Object.keys(N).forEach(function(a){ya[N[a]]=a});var za=[];Object.keys(X).forEach(function(a){za[X[a]]=a});var Ja=Aa.reduce(function(a,b){var c=
Y[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ha=[],Fa=[],xa=0,R={},qa=r.maxTextureUnits,ea=Array(qa).map(function(){return null});g(pa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<qa;++b){var c=ea[b];if(c){if(0<c.bindCount)continue;c.unit=-1}ea[b]=this;a=b;break}O.profile&&C.maxTextureUnits<a+1&&(C.maxTextureUnits=a+1);this.unit=a;d.activeTexture(33984+a);d.bindTexture(this.target,
this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&ka(this)}});O.profile&&(C.getTotalTextureSize=function(){var a=0;Object.keys(R).forEach(function(b){a+=R[b].stats.size});return a});return{create2D:function(a,b){function e(a,b){var g=f.texInfo;ha.call(g);var d=wa();"number"===typeof a?"number"===typeof b?I(d,a|0,b|0):I(d,a|0,a|0):a?(ja(g,a),aa(d,a)):I(d,1,1);g.genMipmaps&&(d.mipmask=(d.width<<1)-1);f.mipmask=d.mipmask;K(f,d);f.internalformat=d.internalformat;
e.width=d.width;e.height=d.height;ba(f);ma(d,3553);oa(g,3553);ia();T(d);O.profile&&(f.stats.size=c(f.internalformat,f.type,d.width,d.height,g.genMipmaps,!1));e.format=Ba[f.internalformat];e.type=Da[f.type];e.mag=Ea[g.magFilter];e.min=ya[g.minFilter];e.wrapS=za[g.wrapS];e.wrapT=za[g.wrapT];return e}var f=new pa(3553);R[f.id]=f;C.textureCount++;e(a,b);e.subimage=function(a,b,c,g){b|=0;c|=0;g|=0;var d=da();K(d,f);d.width=0;d.height=0;ga(d,a);d.width=d.width||(f.width>>g)-b;d.height=d.height||(f.height>>
g)-c;ba(f);la(d,3553,b,c,g);ia();W(d);return e};e.resize=function(a,b){var g=a|0,p=b|0||g;if(g===f.width&&p===f.height)return e;e.width=f.width=g;e.height=f.height=p;ba(f);for(var k=0;f.mipmask>>k;++k)d.texImage2D(3553,k,f.format,g>>k,p>>k,0,f.format,f.type,null);ia();O.profile&&(f.stats.size=c(f.internalformat,f.type,g,p,!1,!1));return e};e._reglType="texture2d";e._texture=f;O.profile&&(e.stats=f.stats);e.destroy=function(){f.decRef()};return e},createCube:function(a,b,e,f,g,p){function k(a,b,e,
f,g,d){var p,n=m.texInfo;ha.call(n);for(p=0;6>p;++p)h[p]=wa();if("number"===typeof a||!a)for(a=a|0||1,p=0;6>p;++p)I(h[p],a,a);else if("object"===typeof a)if(b)aa(h[0],a),aa(h[1],b),aa(h[2],e),aa(h[3],f),aa(h[4],g),aa(h[5],d);else if(ja(n,a),G(m,a),"faces"in a)for(a=a.faces,p=0;6>p;++p)K(h[p],m),aa(h[p],a[p]);else for(p=0;6>p;++p)aa(h[p],a);K(m,h[0]);m.mipmask=n.genMipmaps?(h[0].width<<1)-1:h[0].mipmask;m.internalformat=h[0].internalformat;k.width=h[0].width;k.height=h[0].height;ba(m);for(p=0;6>p;++p)ma(h[p],
34069+p);oa(n,34067);ia();O.profile&&(m.stats.size=c(m.internalformat,m.type,k.width,k.height,n.genMipmaps,!0));k.format=Ba[m.internalformat];k.type=Da[m.type];k.mag=Ea[n.magFilter];k.min=ya[n.minFilter];k.wrapS=za[n.wrapS];k.wrapT=za[n.wrapT];for(p=0;6>p;++p)T(h[p]);return k}var m=new pa(34067);R[m.id]=m;C.cubeCount++;var h=Array(6);k(a,b,e,f,g,p);k.subimage=function(a,b,c,e,f){c|=0;e|=0;f|=0;var g=da();K(g,m);g.width=0;g.height=0;ga(g,b);g.width=g.width||(m.width>>f)-c;g.height=g.height||(m.height>>
f)-e;ba(m);la(g,34069+a,c,e,f);ia();W(g);return k};k.resize=function(a){a|=0;if(a!==m.width){k.width=m.width=a;k.height=m.height=a;ba(m);for(var b=0;6>b;++b)for(var e=0;m.mipmask>>e;++e)d.texImage2D(34069+b,e,m.format,a>>e,a>>e,0,m.format,m.type,null);ia();O.profile&&(m.stats.size=c(m.internalformat,m.type,k.width,k.height,!1,!0));return k}};k._reglType="textureCube";k._texture=m;O.profile&&(k.stats=m.stats);k.destroy=function(){m.decRef()};return k},clear:function(){for(var a=0;a<qa;++a)d.activeTexture(33984+
a),d.bindTexture(3553,null),ea[a]=null;k(R).forEach(ka);C.cubeCount=0;C.textureCount=0},getTexture:function(a){return null},restore:function(){k(R).forEach(function(a){a.texture=d.createTexture();d.bindTexture(a.target,a.texture);for(var b=0;32>b;++b)if(0!==(a.mipmask&1<<b))if(3553===a.target)d.texImage2D(3553,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);else for(var c=0;6>c;++c)d.texImage2D(34069+c,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);
oa(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/flatten":24,"./util/is-array-like":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/pool":29,"./util/to-half-float":31,"./util/values":32}],20:[function(d,l,r){l.exports=function(a,b){function d(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function f(a,b,c){var e=k.pop()||new d;e.startQueryIndex=a;e.endQueryIndex=b;e.sum=0;e.stats=c;v.push(e)}var e=b.ext_disjoint_timer_query;
if(!e)return null;var c=[],g=[],k=[],v=[],h=[],w=[];return{beginQuery:function(a){var b=c.pop()||e.createQueryEXT();e.beginQueryEXT(35007,b);g.push(b);f(g.length-1,g.length,a)},endQuery:function(){e.endQueryEXT(35007)},pushScopeStats:f,update:function(){var a,b;a=g.length;if(0!==a){w.length=Math.max(w.length,a+1);h.length=Math.max(h.length,a+1);h[0]=0;var f=w[0]=0;for(b=a=0;b<g.length;++b){var d=g[b];e.getQueryObjectEXT(d,34919)?(f+=e.getQueryObjectEXT(d,34918),c.push(d)):g[a++]=d;h[b+1]=f;w[b+1]=
a}g.length=a;for(b=a=0;b<v.length;++b){var f=v[b],p=f.startQueryIndex,d=f.endQueryIndex;f.sum+=h[d]-h[p];p=w[p];d=w[d];d===p?(f.stats.gpuTime+=f.sum/1E6,k.push(f)):(f.startQueryIndex=p,f.endQueryIndex=d,v[a++]=f)}v.length=a}},getNumPendingQueries:function(){return g.length},clear:function(){c.push.apply(c,g);for(var a=0;a<c.length;a++)e.deleteQueryEXT(c[a]);g.length=0;c.length=0},restore:function(){g.length=0;c.length=0}}}},{}],21:[function(d,l,r){l.exports="undefined"!==typeof performance&&performance.now?
function(){return performance.now()}:function(){return+new Date}},{}],22:[function(d,l,r){function a(a){return Array.prototype.slice.call(a)}function b(b){return a(b).join("")}var p=d("./extend");l.exports=function(){function f(){var e=[],f=[];return p(function(){e.push.apply(e,a(arguments))},{def:function(){var b="v"+c++;f.push(b);0<arguments.length&&(e.push(b,"="),e.push.apply(e,a(arguments)),e.push(";"));return b},toString:function(){return b([0<f.length?"var "+f+";":"",b(e)])}})}function e(){function b(a,
f){e(a,f,"=",c.def(a,f),";")}var c=f(),e=f(),g=c.toString,d=e.toString;return p(function(){c.apply(c,a(arguments))},{def:c.def,entry:c,exit:e,save:b,set:function(a,e,f){b(a,e);c(a,e,"=",f,";")},toString:function(){return g()+d()}})}var c=0,g=[],d=[],v=f(),h={};return{global:v,link:function(a){for(var b=0;b<d.length;++b)if(d[b]===a)return g[b];b="g"+c++;g.push(b);d.push(a);return b},block:f,proc:function(a,c){function f(){var a="a"+g.length;g.push(a);return a}var g=[];c=c||0;for(var d=0;d<c;++d)f();
var d=e(),k=d.toString;return h[a]=p(d,{arg:f,toString:function(){return b(["function(",g.join(),"){",k(),"}"])}})},scope:e,cond:function(){var c=b(arguments),f=e(),g=e(),d=f.toString,k=g.toString;return p(f,{then:function(){f.apply(f,a(arguments));return this},"else":function(){g.apply(g,a(arguments));return this},toString:function(){var a=k();a&&(a="else{"+a+"}");return b(["if(",c,"){",d(),"}",a])}})},compile:function(){var a=['"use strict";',v,"return {"];Object.keys(h).forEach(function(b){a.push('"',
b,'":',h[b].toString(),",")});a.push("}");var c=b(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,g.concat(c)).apply(null,d)}}}},{"./extend":23}],23:[function(d,l,r){l.exports=function(a,b){for(var d=Object.keys(b),f=0;f<d.length;++f)a[d[f]]=b[d[f]];return a}},{}],24:[function(d,l,r){function a(a,b,c,g,d,p){for(var h=0;h<b;++h)for(var l=a[h],m=0;m<c;++m)for(var t=l[m],z=0;z<g;++z)d[p++]=t[z]}function b(f,e,c,g,d){for(var p=1,h=c+1;h<e.length;++h)p*=e[h];var l=
e[c];if(4===e.length-c){var m=e[c+1],t=e[c+2];e=e[c+3];for(h=0;h<l;++h)a(f[h],m,t,e,g,d),d+=p}else for(h=0;h<l;++h)b(f[h],e,c+1,g,d),d+=p}var p=d("./pool");l.exports={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(f,e,c,g){var d=1;if(e.length)for(var v=0;v<e.length;++v)d*=e[v];else d=0;c=g||p.allocType(c,d);switch(e.length){case 0:break;case 1:g=e[0];for(e=0;e<g;++e)c[e]=f[e];break;case 2:g=e[0];e=e[1];for(v=d=0;v<g;++v)for(var h=f[v],l=0;l<e;++l)c[d++]=
h[l];break;case 3:a(f,e[0],e[1],e[2],c,0);break;default:b(f,e,0,c,0)}return c}}},{"./pool":29}],25:[function(d,l,r){var a=d("./is-typed-array");l.exports=function(b){return Array.isArray(b)||a(b)}},{"./is-typed-array":27}],26:[function(d,l,r){var a=d("./is-typed-array");l.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":27}],27:[function(d,
l,r){var a=d("../constants/arraytypes.json");l.exports=function(b){return Object.prototype.toString.call(b)in a}},{"../constants/arraytypes.json":4}],28:[function(d,l,r){l.exports=function(a,b){for(var d=Array(a),f=0;f<a;++f)d[f]=b(f);return d}},{}],29:[function(d,l,r){function a(a){var b,f;b=(65535<a)<<4;a>>>=b;f=(255<a)<<3;a>>>=f;b|=f;f=(15<a)<<2;a>>>=f;b|=f;f=(3<a)<<1;return b|f|a>>>f>>1}function b(b){a:{for(var c=16;268435456>=c;c*=16)if(b<=c){b=c;break a}b=0}c=f[a(b)>>2];return 0<c.length?c.pop():
new ArrayBuffer(b)}function p(b){f[a(b.byteLength)>>2].push(b)}var f=d("./loop")(8,function(){return[]});l.exports={alloc:b,free:p,allocType:function(a,c){var f=null;switch(a){case 5120:f=new Int8Array(b(c),0,c);break;case 5121:f=new Uint8Array(b(c),0,c);break;case 5122:f=new Int16Array(b(2*c),0,c);break;case 5123:f=new Uint16Array(b(2*c),0,c);break;case 5124:f=new Int32Array(b(4*c),0,c);break;case 5125:f=new Uint32Array(b(4*c),0,c);break;case 5126:f=new Float32Array(b(4*c),0,c);break;default:return null}return f.length!==
c?f.subarray(0,c):f},freeType:function(a){p(a.buffer)}}},{"./loop":28}],30:[function(d,l,r){l.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){return setTimeout(a,16)},cancel:clearTimeout}},{}],31:[function(d,l,r){var a=d("./pool"),b=new Float32Array(1),p=new Uint32Array(b.buffer);l.exports=function(f){for(var e=a.allocType(5123,f.length),
c=0;c<f.length;++c)if(isNaN(f[c]))e[c]=65535;else if(Infinity===f[c])e[c]=31744;else if(-Infinity===f[c])e[c]=64512;else{b[0]=f[c];var g=p[0],d=g>>>31<<15,v=(g<<1>>>24)-127,g=g>>13&1023;e[c]=-24>v?d:-14>v?d+(g+1024>>-14-v):15<v?d+31744:d+(v+15<<10)+g}return e}},{"./pool":29}],32:[function(d,l,r){l.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],33:[function(d,l,r){function a(a,b,f){function d(){var b=window.innerWidth,g=window.innerHeight;a!==document.body&&(g=a.getBoundingClientRect(),
b=g.right-g.left,g=g.top-g.bottom);p.width=f*b;p.height=f*g;e(p.style,{width:b+"px",height:g+"px"})}var p=document.createElement("canvas");e(p.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(p);a===document.body&&(p.style.position="absolute",e(a.style,{margin:0,padding:0}));window.addEventListener("resize",d,!1);d();return{canvas:p,onDestroy:function(){window.removeEventListener("resize",d);a.removeChild(p)}}}function b(a,b){function e(f){try{return a.getContext(f,b)}catch(d){return null}}
return e("webgl")||e("experimental-webgl")||e("webgl-experimental")}function p(a){return"string"===typeof a?a.split():a}function f(a){return"string"===typeof a?document.querySelector(a):a}var e=d("./util/extend");l.exports=function(c){var e=c||{},d,v,h,l;c={};var m=[],t=[],z="undefined"===typeof window?1:window.devicePixelRatio,r=!1,x=function(a){},u=function(){};"string"===typeof e?d=document.querySelector(e):"object"===typeof e&&("string"===typeof e.nodeName&&"function"===typeof e.appendChild&&
"function"===typeof e.getBoundingClientRect?d=e:"function"===typeof e.drawArrays||"function"===typeof e.drawElements?(l=e,h=l.canvas):("gl"in e?l=e.gl:"canvas"in e?h=f(e.canvas):"container"in e&&(v=f(e.container)),"attributes"in e&&(c=e.attributes),"extensions"in e&&(m=p(e.extensions)),"optionalExtensions"in e&&(t=p(e.optionalExtensions)),"onDone"in e&&(x=e.onDone),"profile"in e&&(r=!!e.profile),"pixelRatio"in e&&(z=+e.pixelRatio)));d&&("canvas"===d.nodeName.toLowerCase()?h=d:v=d);if(!l){if(!h){d=
a(v||document.body,x,z);if(!d)return null;h=d.canvas;u=d.onDestroy}l=b(h,c)}return l?{gl:l,canvas:h,container:v,extensions:m,optionalExtensions:t,pixelRatio:z,profile:r,onDone:x,onDestroy:u}:(u(),x("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],34:[function(d,l,r){l.exports=function(a,b){var d=b[0],f=b[1],e=b[2],c=b[3],g=b[4],k=b[5],v=b[6],h=b[7],l=b[8],m=b[9],t=b[10],z=b[11],r=b[12],x=b[13],u=b[14],A=b[15];a[0]=k*(t*A-z*u)-
m*(v*A-h*u)+x*(v*z-h*t);a[1]=-(f*(t*A-z*u)-m*(e*A-c*u)+x*(e*z-c*t));a[2]=f*(v*A-h*u)-k*(e*A-c*u)+x*(e*h-c*v);a[3]=-(f*(v*z-h*t)-k*(e*z-c*t)+m*(e*h-c*v));a[4]=-(g*(t*A-z*u)-l*(v*A-h*u)+r*(v*z-h*t));a[5]=d*(t*A-z*u)-l*(e*A-c*u)+r*(e*z-c*t);a[6]=-(d*(v*A-h*u)-g*(e*A-c*u)+r*(e*h-c*v));a[7]=d*(v*z-h*t)-g*(e*z-c*t)+l*(e*h-c*v);a[8]=g*(m*A-z*x)-l*(k*A-h*x)+r*(k*z-h*m);a[9]=-(d*(m*A-z*x)-l*(f*A-c*x)+r*(f*z-c*m));a[10]=d*(k*A-h*x)-g*(f*A-c*x)+r*(f*h-c*k);a[11]=-(d*(k*z-h*m)-g*(f*z-c*m)+l*(f*h-c*k));a[12]=
-(g*(m*u-t*x)-l*(k*u-v*x)+r*(k*t-v*m));a[13]=d*(m*u-t*x)-l*(f*u-e*x)+r*(f*t-e*m);a[14]=-(d*(k*u-v*x)-g*(f*u-e*x)+r*(f*v-e*k));a[15]=d*(k*t-v*m)-g*(f*t-e*m)+l*(f*v-e*k);return a}},{}],35:[function(d,l,r){l.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],36:[function(d,l,r){l.exports=function(a,b){a[0]=b[0];a[1]=b[1];
a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],37:[function(d,l,r){l.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],38:[function(d,l,r){l.exports=function(a){var b=a[0],d=a[1],f=a[2],e=a[3],c=a[4],g=a[5],k=a[6],v=a[7],h=a[8],l=a[9],m=a[10],t=a[11],r=
a[12],F=a[13],x=a[14];a=a[15];return(b*g-d*c)*(m*a-t*x)-(b*k-f*c)*(l*a-t*F)+(b*v-e*c)*(l*x-m*F)+(d*k-f*g)*(h*a-t*r)-(d*v-e*g)*(h*x-m*r)+(f*v-e*k)*(h*F-l*r)}},{}],39:[function(d,l,r){l.exports=function(a,b){var d=b[0],f=b[1],e=b[2],c=b[3],g=d+d,k=f+f,v=e+e,d=d*g,h=f*g,f=f*k,l=e*g,m=e*k,e=e*v,g=c*g,k=c*k,c=c*v;a[0]=1-f-e;a[1]=h+c;a[2]=l-k;a[3]=0;a[4]=h-c;a[5]=1-d-e;a[6]=m+g;a[7]=0;a[8]=l+k;a[9]=m-g;a[10]=1-d-f;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],40:[function(d,l,r){l.exports=function(a,
b,d){var f=b[0],e=b[1],c=b[2],g=b[3],k=f+f,l=e+e,h=c+c;b=f*k;var w=f*l,f=f*h,m=e*l,e=e*h,c=c*h,k=g*k,l=g*l,g=g*h;a[0]=1-(m+c);a[1]=w+g;a[2]=f-l;a[3]=0;a[4]=w-g;a[5]=1-(b+c);a[6]=e+k;a[7]=0;a[8]=f+l;a[9]=e-k;a[10]=1-(b+m);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a}},{}],41:[function(d,l,r){l.exports=function(a,b,d,f,e,c,g){var k=1/(d-b),l=1/(e-f),h=1/(c-g);a[0]=2*c*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*c*l;a[6]=0;a[7]=0;a[8]=(d+b)*k;a[9]=(e+f)*l;a[10]=(g+c)*h;a[11]=-1;a[12]=0;a[13]=0;
a[14]=g*c*2*h;a[15]=0;return a}},{}],42:[function(d,l,r){l.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],43:[function(d,l,r){l.exports={create:d("./create"),clone:d("./clone"),copy:d("./copy"),identity:d("./identity"),transpose:d("./transpose"),invert:d("./invert"),adjoint:d("./adjoint"),determinant:d("./determinant"),multiply:d("./multiply"),translate:d("./translate"),scale:d("./scale"),rotate:d("./rotate"),
rotateX:d("./rotateX"),rotateY:d("./rotateY"),rotateZ:d("./rotateZ"),fromRotationTranslation:d("./fromRotationTranslation"),fromQuat:d("./fromQuat"),frustum:d("./frustum"),perspective:d("./perspective"),perspectiveFromFieldOfView:d("./perspectiveFromFieldOfView"),ortho:d("./ortho"),lookAt:d("./lookAt"),str:d("./str")}},{"./adjoint":34,"./clone":35,"./copy":36,"./create":37,"./determinant":38,"./fromQuat":39,"./fromRotationTranslation":40,"./frustum":41,"./identity":42,"./invert":44,"./lookAt":45,
"./multiply":46,"./ortho":47,"./perspective":48,"./perspectiveFromFieldOfView":49,"./rotate":50,"./rotateX":51,"./rotateY":52,"./rotateZ":53,"./scale":54,"./str":55,"./translate":56,"./transpose":57}],44:[function(d,l,r){l.exports=function(a,b){var d=b[0],f=b[1],e=b[2],c=b[3],g=b[4],k=b[5],l=b[6],h=b[7],w=b[8],m=b[9],t=b[10],r=b[11],F=b[12],x=b[13],u=b[14],A=b[15],C=d*k-f*g,D=d*l-e*g,y=d*h-c*g,n=f*l-e*k,L=f*h-c*k,J=e*h-c*l,Z=w*x-m*F,Q=w*u-t*F,V=w*A-r*F,O=m*u-t*x,B=m*A-r*x,K=t*A-r*u,G=C*K-D*B+y*O+
n*V-L*Q+J*Z;if(!G)return null;G=1/G;a[0]=(k*K-l*B+h*O)*G;a[1]=(e*B-f*K-c*O)*G;a[2]=(x*J-u*L+A*n)*G;a[3]=(t*L-m*J-r*n)*G;a[4]=(l*V-g*K-h*Q)*G;a[5]=(d*K-e*V+c*Q)*G;a[6]=(u*y-F*J-A*D)*G;a[7]=(w*J-t*y+r*D)*G;a[8]=(g*B-k*V+h*Z)*G;a[9]=(f*V-d*B-c*Z)*G;a[10]=(F*L-x*y+A*C)*G;a[11]=(m*y-w*L-r*C)*G;a[12]=(k*Q-g*O-l*Z)*G;a[13]=(d*O-f*Q+e*Z)*G;a[14]=(x*D-F*n-u*C)*G;a[15]=(w*n-m*D+t*C)*G;return a}},{}],45:[function(d,l,r){var a=d("./identity");l.exports=function(b,d,f,e){var c,g,k,l,h,w,m,t,r=d[0],F=d[1];d=d[2];
k=e[0];l=e[1];g=e[2];m=f[0];e=f[1];c=f[2];if(1E-6>Math.abs(r-m)&&1E-6>Math.abs(F-e)&&1E-6>Math.abs(d-c))return a(b);f=r-m;e=F-e;m=d-c;t=1/Math.sqrt(f*f+e*e+m*m);f*=t;e*=t;m*=t;c=l*m-g*e;g=g*f-k*m;k=k*e-l*f;(t=Math.sqrt(c*c+g*g+k*k))?(t=1/t,c*=t,g*=t,k*=t):k=g=c=0;l=e*k-m*g;h=m*c-f*k;w=f*g-e*c;(t=Math.sqrt(l*l+h*h+w*w))?(t=1/t,l*=t,h*=t,w*=t):w=h=l=0;b[0]=c;b[1]=l;b[2]=f;b[3]=0;b[4]=g;b[5]=h;b[6]=e;b[7]=0;b[8]=k;b[9]=w;b[10]=m;b[11]=0;b[12]=-(c*r+g*F+k*d);b[13]=-(l*r+h*F+w*d);b[14]=-(f*r+e*F+m*d);
b[15]=1;return b}},{"./identity":42}],46:[function(d,l,r){l.exports=function(a,b,d){var f=b[0],e=b[1],c=b[2],g=b[3],k=b[4],l=b[5],h=b[6],w=b[7],m=b[8],t=b[9],r=b[10],F=b[11],x=b[12],u=b[13],A=b[14];b=b[15];var C=d[0],D=d[1],y=d[2],n=d[3];a[0]=C*f+D*k+y*m+n*x;a[1]=C*e+D*l+y*t+n*u;a[2]=C*c+D*h+y*r+n*A;a[3]=C*g+D*w+y*F+n*b;C=d[4];D=d[5];y=d[6];n=d[7];a[4]=C*f+D*k+y*m+n*x;a[5]=C*e+D*l+y*t+n*u;a[6]=C*c+D*h+y*r+n*A;a[7]=C*g+D*w+y*F+n*b;C=d[8];D=d[9];y=d[10];n=d[11];a[8]=C*f+D*k+y*m+n*x;a[9]=C*e+D*l+y*t+
n*u;a[10]=C*c+D*h+y*r+n*A;a[11]=C*g+D*w+y*F+n*b;C=d[12];D=d[13];y=d[14];n=d[15];a[12]=C*f+D*k+y*m+n*x;a[13]=C*e+D*l+y*t+n*u;a[14]=C*c+D*h+y*r+n*A;a[15]=C*g+D*w+y*F+n*b;return a}},{}],47:[function(d,l,r){l.exports=function(a,b,d,f,e,c,g){var k=1/(b-d),l=1/(f-e),h=1/(c-g);a[0]=-2*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*l;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*h;a[11]=0;a[12]=(b+d)*k;a[13]=(e+f)*l;a[14]=(g+c)*h;a[15]=1;return a}},{}],48:[function(d,l,r){l.exports=function(a,b,d,f,e){b=1/Math.tan(b/2);var c=
1/(f-e);a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+f)*c;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*f*c;a[15]=0;return a}},{}],49:[function(d,l,r){l.exports=function(a,b,d,f){var e=Math.tan(b.upDegrees*Math.PI/180),c=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var k=2/(g+b),l=2/(e+c);a[0]=k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=l;a[6]=0;a[7]=0;a[8]=-((g-b)*k*.5);a[9]=(e-c)*l*.5;a[10]=f/(d-f);a[11]=-1;a[12]=
0;a[13]=0;a[14]=f*d/(d-f);a[15]=0;return a}},{}],50:[function(d,l,r){l.exports=function(a,b,d,f){var e=f[0],c=f[1];f=f[2];var g=Math.sqrt(e*e+c*c+f*f),k,l,h,r,m,t,z,F,x,u,A,C,D,y,n,L,J,Z,Q,V;if(1E-6>Math.abs(g))return null;g=1/g;e*=g;c*=g;f*=g;k=Math.sin(d);l=Math.cos(d);h=1-l;d=b[0];g=b[1];r=b[2];m=b[3];t=b[4];z=b[5];F=b[6];x=b[7];u=b[8];A=b[9];C=b[10];D=b[11];y=e*e*h+l;n=c*e*h+f*k;L=f*e*h-c*k;J=e*c*h-f*k;Z=c*c*h+l;Q=f*c*h+e*k;V=e*f*h+c*k;e=c*f*h-e*k;c=f*f*h+l;a[0]=d*y+t*n+u*L;a[1]=g*y+z*n+A*L;a[2]=
r*y+F*n+C*L;a[3]=m*y+x*n+D*L;a[4]=d*J+t*Z+u*Q;a[5]=g*J+z*Z+A*Q;a[6]=r*J+F*Z+C*Q;a[7]=m*J+x*Z+D*Q;a[8]=d*V+t*e+u*c;a[9]=g*V+z*e+A*c;a[10]=r*V+F*e+C*c;a[11]=m*V+x*e+D*c;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],51:[function(d,l,r){l.exports=function(a,b,d){var f=Math.sin(d);d=Math.cos(d);var e=b[4],c=b[5],g=b[6],k=b[7],l=b[8],h=b[9],r=b[10],m=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*d+l*f;a[5]=c*d+h*f;
a[6]=g*d+r*f;a[7]=k*d+m*f;a[8]=l*d-e*f;a[9]=h*d-c*f;a[10]=r*d-g*f;a[11]=m*d-k*f;return a}},{}],52:[function(d,l,r){l.exports=function(a,b,d){var f=Math.sin(d);d=Math.cos(d);var e=b[0],c=b[1],g=b[2],k=b[3],l=b[8],h=b[9],r=b[10],m=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d-l*f;a[1]=c*d-h*f;a[2]=g*d-r*f;a[3]=k*d-m*f;a[8]=e*f+l*d;a[9]=c*f+h*d;a[10]=g*f+r*d;a[11]=k*f+m*d;return a}},{}],53:[function(d,l,r){l.exports=function(a,b,d){var f=
Math.sin(d);d=Math.cos(d);var e=b[0],c=b[1],g=b[2],k=b[3],l=b[4],h=b[5],r=b[6],m=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d+l*f;a[1]=c*d+h*f;a[2]=g*d+r*f;a[3]=k*d+m*f;a[4]=l*d-e*f;a[5]=h*d-c*f;a[6]=r*d-g*f;a[7]=m*d-k*f;return a}},{}],54:[function(d,l,r){l.exports=function(a,b,d){var f=d[0],e=d[1];d=d[2];a[0]=b[0]*f;a[1]=b[1]*f;a[2]=b[2]*f;a[3]=b[3]*f;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=
b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],55:[function(d,l,r){l.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],56:[function(d,l,r){l.exports=function(a,b,d){var f=d[0],e=d[1];d=d[2];var c,g,k,l,h,r,m,t,z,F,x,u;b===a?(a[12]=b[0]*f+b[4]*e+b[8]*d+b[12],a[13]=b[1]*f+b[5]*e+b[9]*d+b[13],a[14]=b[2]*f+b[6]*
e+b[10]*d+b[14],a[15]=b[3]*f+b[7]*e+b[11]*d+b[15]):(c=b[0],g=b[1],k=b[2],l=b[3],h=b[4],r=b[5],m=b[6],t=b[7],z=b[8],F=b[9],x=b[10],u=b[11],a[0]=c,a[1]=g,a[2]=k,a[3]=l,a[4]=h,a[5]=r,a[6]=m,a[7]=t,a[8]=z,a[9]=F,a[10]=x,a[11]=u,a[12]=c*f+h*e+z*d+b[12],a[13]=g*f+r*e+F*d+b[13],a[14]=k*f+m*e+x*d+b[14],a[15]=l*f+t*e+u*d+b[15]);return a}},{}],57:[function(d,l,r){l.exports=function(a,b){if(a===b){var d=b[1],f=b[2],e=b[3],c=b[6],g=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=d;a[6]=b[9];a[7]=b[13];a[8]=
f;a[9]=c;a[11]=b[14];a[12]=e;a[13]=g;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],58:[function(d,l,r){function a(a,e,d,f){f[0]=b(255*a);f[1]=b(255*e);f[2]=b(255*d)}var b=Math.round,p=Math.min,f=Math.max,e=Math.ceil;l.exports=function(b,d,k,l){l=l||[0,0,0];b%=360;d=f(0,p(d,1));k=f(0,p(k,1));if(d){d=(1-d)*k;var h=k-d,r=b%60;switch(b/60|0){case 0:a(k,
h*b/60+d,d,l);break;case 1:a(h*(60-r)/60+d,k,d,l);break;case 2:a(d,k,h*r/60+d,l);break;case 3:a(d,h*(60-r)/60+d,k,l);break;case 4:a(h*r/60+d,d,k,l);break;case 5:a(k,d,h*(60-r)/60+d,l)}}else l[0]=l[1]=l[2]=e(255*k);return l}},{}],59:[function(d,l,r){function a(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var b=d("./lib/util/extend"),p=d("./lib/dynamic"),f=d("./lib/util/raf"),e=d("./lib/util/clock"),c=d("./lib/strings"),g=d("./lib/webgl"),k=d("./lib/extension"),v=d("./lib/limits"),
h=d("./lib/buffer"),w=d("./lib/elements"),m=d("./lib/texture"),t=d("./lib/renderbuffer"),z=d("./lib/framebuffer"),F=d("./lib/attribute"),x=d("./lib/shader"),u=d("./lib/read"),A=d("./lib/core"),C=d("./lib/stats"),D=d("./lib/timer");l.exports=function(d){function l(){if(0===N.length)I&&I.update(),S=null;else{S=f.next(l);K();for(var a=N.length-1;0<=a;--a){var b=N[a];b&&b(T,null,0)}H.flush();I&&I.update()}}function r(){!S&&0<N.length&&(S=f.next(l))}function J(){S&&(f.cancel(l),S=null)}function Z(a){a.preventDefault();
J();na.forEach(function(a){a()})}function Q(a){H.getError();la.restore();pa.restore();ja.restore();ba.restore();ia.restore();ka.restore();I&&I.restore();ca.procs.refresh();r();U.forEach(function(a){a()})}function V(a){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var e=a[c];p.isDynamic(e)?d[c]=p.unbox(e,c):b[c]=e});return{dynamic:d,"static":b}}function d(a){for(;n.length<a;)n.push(null);return n}var e=c(a.context||{}),f=c(a.uniforms||{}),g=c(a.attributes||{}),h=c(function(a){function c(a){if(a in
d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=b({},a);delete d.uniforms;delete d.attributes;delete d.context;"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(a));a={gpuTime:0,cpuTime:0,count:0};var e=ca.compile(h,g,f,e,a),k=e.draw,l=e.batch,m=e.scope,n=[];return b(function(a,b){var c;if("function"===typeof a)return m.call(this,
null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)m.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)m.call(this,a[c],b,c);else return m.call(this,a,b,0);else if("number"===typeof a){if(0<a)return l.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return l.call(this,a,a.length)}else return k.call(this,a)},{stats:a})}function O(b){N.push(b);r();return{cancel:function(){function c(){var b=a(N,c);N[b]=N[N.length-1];--N.length;0>=N.length&&J()}var d=
a(N,b);N[d]=c}}}function B(){var a=X.viewport,b=X.scissor_box;a[0]=a[1]=b[0]=b[1]=0;T.viewportWidth=T.framebufferWidth=T.drawingBufferWidth=a[2]=b[2]=H.drawingBufferWidth;T.viewportHeight=T.framebufferHeight=T.drawingBufferHeight=a[3]=b[3]=H.drawingBufferHeight}function K(){T.tick+=1;T.time=sa();B();ca.procs.poll()}function G(){B();ca.procs.refresh();I&&I.update()}function sa(){return(e()-aa)/1E3}d=g(d);if(!d)return null;var H=d.gl,ga=H.getContextAttributes();H.isContextLost();var la=k(H,d);if(!la)return null;
var da=c(),W=C(),P=la.extensions,I=D(H,P),aa=e(),ma=H.drawingBufferWidth,wa=H.drawingBufferHeight,T={tick:0,time:0,viewportWidth:ma,viewportHeight:wa,framebufferWidth:ma,framebufferHeight:wa,drawingBufferWidth:ma,drawingBufferHeight:wa,pixelRatio:d.pixelRatio},ha=v(H,P),ja=h(H,W,d),oa=w(H,P,ja,W),ma=F(H,P,ha,ja,da),pa=x(H,da,W,d),ba=m(H,P,ha,function(){ca.procs.poll()},T,W,d),ia=t(H,P,ha,W,d),ka=z(H,P,ha,ba,ia,W),ca=A(H,da,P,ha,ja,oa,ba,ka,{},ma,pa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},
T,I,d),da=u(H,ka,ca.procs.poll,T,ga,P),X=ca.next,fa=H.canvas,N=[],na=[],U=[],Y=[d.onDestroy],S=null;fa&&(fa.addEventListener("webglcontextlost",Z,!1),fa.addEventListener("webglcontextrestored",Q,!1));G();ga=b(V,{clear:function(a){var b=0;ca.procs.poll();var c=a.color;c&&(H.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(H.clearDepth(+a.depth),b|=256);"stencil"in a&&(H.clearStencil(a.stencil|0),b|=1024);H.clear(b)},prop:p.define.bind(null,1),context:p.define.bind(null,2),"this":p.define.bind(null,
3),draw:V({}),buffer:function(a){return ja.create(a,34962,!1,!1)},elements:function(a){return oa.create(a,!1)},texture:ba.create2D,cube:ba.createCube,renderbuffer:ia.create,framebuffer:ka.create,framebufferCube:ka.createCube,attributes:ga,frame:O,on:function(a,b){var c;switch(a){case "frame":return O(b);case "lost":c=na;break;case "restore":c=U;break;case "destroy":c=Y}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ha,hasExtension:function(a){return 0<=
ha.extensions.indexOf(a.toLowerCase())},read:da,destroy:function(){N.length=0;J();fa&&(fa.removeEventListener("webglcontextlost",Z),fa.removeEventListener("webglcontextrestored",Q));pa.clear();ka.clear();ia.clear();ba.clear();oa.clear();ja.clear();I&&I.clear();Y.forEach(function(a){a()})},_gl:H,_refresh:G,poll:function(){K();I&&I.update()},now:sa,stats:W});d.onDone(null,ga);return ga}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,
"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":30,"./lib/webgl":33}]},{},[1]);

        </script>
        </body>
      </html>